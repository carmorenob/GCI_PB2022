$PBExportHeader$w_para_grales_new.srw
forward
global type w_para_grales_new from window
end type
type rb_1 from radiobutton within w_para_grales_new
end type
type cb_7 from picturebutton within w_para_grales_new
end type
type pb_2 from picturebutton within w_para_grales_new
end type
type pb_1 from picturebutton within w_para_grales_new
end type
type ilim_pres from checkbox within w_para_grales_new
end type
type ilim_cost from checkbox within w_para_grales_new
end type
type ilim_nomi from checkbox within w_para_grales_new
end type
type ilim_acti from checkbox within w_para_grales_new
end type
type ilim_cart from checkbox within w_para_grales_new
end type
type ilim_sumi from checkbox within w_para_grales_new
end type
type ilim_teso from checkbox within w_para_grales_new
end type
type ilim_conta from checkbox within w_para_grales_new
end type
type ilim_asis from checkbox within w_para_grales_new
end type
type st_37 from statictext within w_para_grales_new
end type
type sle_vers_adm from singlelineedit within w_para_grales_new
end type
type sle_vers_as from singlelineedit within w_para_grales_new
end type
type st_36 from statictext within w_para_grales_new
end type
type st_200 from statictext within w_para_grales_new
end type
type em_pres from editmask within w_para_grales_new
end type
type em_cost from editmask within w_para_grales_new
end type
type em_nomi from editmask within w_para_grales_new
end type
type em_acti from editmask within w_para_grales_new
end type
type em_cart from editmask within w_para_grales_new
end type
type em_sumi from editmask within w_para_grales_new
end type
type em_teso from editmask within w_para_grales_new
end type
type em_2 from editmask within w_para_grales_new
end type
type gb_9 from groupbox within w_para_grales_new
end type
type c_asis from checkbox within w_para_grales_new
end type
type st_11 from statictext within w_para_grales_new
end type
type tab_1 from tab within w_para_grales_new
end type
type tp_gral from userobject within tab_1
end type
type tab_4 from tab within tp_gral
end type
type tabpage_2 from userobject within tab_4
end type
type dw_4 from datawindow within tabpage_2
end type
type tabpage_2 from userobject within tab_4
dw_4 dw_4
end type
type tab_4 from tab within tp_gral
tabpage_2 tabpage_2
end type
type sle_1 from singlelineedit within tp_gral
end type
type st_1 from statictext within tp_gral
end type
type tab_2 from tab within tp_gral
end type
type tp_1 from userobject within tab_2
end type
type ddlb_1 from dropdownlistbox within tp_1
end type
type cb_2 from commandbutton within tp_1
end type
type st_4 from statictext within tp_1
end type
type st_33 from statictext within tp_1
end type
type sle_logidod from singlelineedit within tp_1
end type
type st_34 from statictext within tp_1
end type
type sle_logpassod from singlelineedit within tp_1
end type
type tp_1 from userobject within tab_2
ddlb_1 ddlb_1
cb_2 cb_2
st_4 st_4
st_33 st_33
sle_logidod sle_logidod
st_34 st_34
sle_logpassod sle_logpassod
end type
type tp_2 from userobject within tab_2
end type
type ddlb_2 from dropdownlistbox within tp_2
end type
type st_3 from statictext within tp_2
end type
type sle_serv from singlelineedit within tp_2
end type
type sle_bd from singlelineedit within tp_2
end type
type sle_logid from singlelineedit within tp_2
end type
type sle_logpass from singlelineedit within tp_2
end type
type st_2 from statictext within tp_2
end type
type st_21 from statictext within tp_2
end type
type st_22 from statictext within tp_2
end type
type st_23 from statictext within tp_2
end type
type tp_2 from userobject within tab_2
ddlb_2 ddlb_2
st_3 st_3
sle_serv sle_serv
sle_bd sle_bd
sle_logid sle_logid
sle_logpass sle_logpass
st_2 st_2
st_21 st_21
st_22 st_22
st_23 st_23
end type
type tp_ole from userobject within tab_2
end type
type cb_10 from commandbutton within tp_ole
end type
type st_42 from statictext within tp_ole
end type
type sle_6 from singlelineedit within tp_ole
end type
type st_41 from statictext within tp_ole
end type
type cbx_1 from checkbox within tp_ole
end type
type ddlb_3 from dropdownlistbox within tp_ole
end type
type tp_ole from userobject within tab_2
cb_10 cb_10
st_42 st_42
sle_6 sle_6
st_41 st_41
cbx_1 cbx_1
ddlb_3 ddlb_3
end type
type tab_2 from tab within tp_gral
tp_1 tp_1
tp_2 tp_2
tp_ole tp_ole
end type
type gb_1 from groupbox within tp_gral
end type
type tp_gral from userobject within tab_1
tab_4 tab_4
sle_1 sle_1
st_1 st_1
tab_2 tab_2
gb_1 gb_1
end type
type tabpage_1 from userobject within tab_1
end type
type tab_5 from tab within tabpage_1
end type
type tabpage_4 from userobject within tab_5
end type
type tab_3 from tab within tabpage_4
end type
type tabpage_6 from userobject within tab_3
end type
type st_38 from statictext within tabpage_6
end type
type sle_capi_pas_od from singlelineedit within tabpage_6
end type
type st_35 from statictext within tabpage_6
end type
type sle_4 from singlelineedit within tabpage_6
end type
type cb_1 from commandbutton within tabpage_6
end type
type ddlb_5 from dropdownlistbox within tabpage_6
end type
type st_29 from statictext within tabpage_6
end type
type tabpage_6 from userobject within tab_3
st_38 st_38
sle_capi_pas_od sle_capi_pas_od
st_35 st_35
sle_4 sle_4
cb_1 cb_1
ddlb_5 ddlb_5
st_29 st_29
end type
type tabpage_7 from userobject within tab_3
end type
type ddlb_7 from dropdownlistbox within tabpage_7
end type
type st_54 from statictext within tabpage_7
end type
type sle_capi_pas_syb from singlelineedit within tabpage_7
end type
type st_53 from statictext within tabpage_7
end type
type sle_9 from singlelineedit within tabpage_7
end type
type st_52 from statictext within tabpage_7
end type
type sle_10 from singlelineedit within tabpage_7
end type
type st_44 from statictext within tabpage_7
end type
type sle_8 from singlelineedit within tabpage_7
end type
type st_40 from statictext within tabpage_7
end type
type tabpage_7 from userobject within tab_3
ddlb_7 ddlb_7
st_54 st_54
sle_capi_pas_syb sle_capi_pas_syb
st_53 st_53
sle_9 sle_9
st_52 st_52
sle_10 sle_10
st_44 st_44
sle_8 sle_8
st_40 st_40
end type
type tabpage_8 from userobject within tab_3
end type
type cb_4 from commandbutton within tabpage_8
end type
type sle_con from singlelineedit within tabpage_8
end type
type st_27 from statictext within tabpage_8
end type
type ddlb_6 from dropdownlistbox within tabpage_8
end type
type st_26 from statictext within tabpage_8
end type
type cbx_4 from checkbox within tabpage_8
end type
type tabpage_8 from userobject within tab_3
cb_4 cb_4
sle_con sle_con
st_27 st_27
ddlb_6 ddlb_6
st_26 st_26
cbx_4 cbx_4
end type
type tab_3 from tab within tabpage_4
tabpage_6 tabpage_6
tabpage_7 tabpage_7
tabpage_8 tabpage_8
end type
type cbx_3 from checkbox within tabpage_4
end type
type tabpage_4 from userobject within tab_5
tab_3 tab_3
cbx_3 cbx_3
end type
type tabpage_5 from userobject within tab_5
end type
type cbx_5 from checkbox within tabpage_5
end type
type tab_6 from tab within tabpage_5
end type
type tabpage_9 from userobject within tab_6
end type
type st_45 from statictext within tabpage_9
end type
type ddlb_8 from dropdownlistbox within tabpage_9
end type
type cb_3 from commandbutton within tabpage_9
end type
type sle_11 from singlelineedit within tabpage_9
end type
type st_43 from statictext within tabpage_9
end type
type sle_12 from singlelineedit within tabpage_9
end type
type st_28 from statictext within tabpage_9
end type
type tabpage_9 from userobject within tab_6
st_45 st_45
ddlb_8 ddlb_8
cb_3 cb_3
sle_11 sle_11
st_43 st_43
sle_12 sle_12
st_28 st_28
end type
type tabpage_10 from userobject within tab_6
end type
type st_50 from statictext within tabpage_10
end type
type sle_13 from singlelineedit within tabpage_10
end type
type st_49 from statictext within tabpage_10
end type
type sle_15 from singlelineedit within tabpage_10
end type
type st_48 from statictext within tabpage_10
end type
type sle_14 from singlelineedit within tabpage_10
end type
type st_47 from statictext within tabpage_10
end type
type sle_16 from singlelineedit within tabpage_10
end type
type st_46 from statictext within tabpage_10
end type
type ddlb_9 from dropdownlistbox within tabpage_10
end type
type tabpage_10 from userobject within tab_6
st_50 st_50
sle_13 sle_13
st_49 st_49
sle_15 sle_15
st_48 st_48
sle_14 sle_14
st_47 st_47
sle_16 sle_16
st_46 st_46
ddlb_9 ddlb_9
end type
type tabpage_11 from userobject within tab_6
end type
type cb_8 from commandbutton within tabpage_11
end type
type cbx_2 from checkbox within tabpage_11
end type
type st_55 from statictext within tabpage_11
end type
type ddlb_10 from dropdownlistbox within tabpage_11
end type
type st_51 from statictext within tabpage_11
end type
type sle_17 from singlelineedit within tabpage_11
end type
type tabpage_11 from userobject within tab_6
cb_8 cb_8
cbx_2 cbx_2
st_55 st_55
ddlb_10 ddlb_10
st_51 st_51
sle_17 sle_17
end type
type tab_6 from tab within tabpage_5
tabpage_9 tabpage_9
tabpage_10 tabpage_10
tabpage_11 tabpage_11
end type
type tabpage_5 from userobject within tab_5
cbx_5 cbx_5
tab_6 tab_6
end type
type tab_5 from tab within tabpage_1
tabpage_4 tabpage_4
tabpage_5 tabpage_5
end type
type st_24 from statictext within tabpage_1
end type
type st_20 from statictext within tabpage_1
end type
type st_10 from statictext within tabpage_1
end type
type st_9 from statictext within tabpage_1
end type
type st_39 from statictext within tabpage_1
end type
type d_ting from dropdownlistbox within tabpage_1
end type
type cbx_rf from checkbox within tabpage_1
end type
type cbx_pideprof from checkbox within tabpage_1
end type
type cbx_muevek from checkbox within tabpage_1
end type
type cb_6 from commandbutton within tabpage_1
end type
type cb_5 from commandbutton within tabpage_1
end type
type dw_3 from datawindow within tabpage_1
end type
type st_8 from statictext within tabpage_1
end type
type dw_2 from datawindow within tabpage_1
end type
type dw_1 from datawindow within tabpage_1
end type
type st_7 from statictext within tabpage_1
end type
type st_6 from statictext within tabpage_1
end type
type gb_2 from groupbox within tabpage_1
end type
type dw_alm_cext from datawindow within tabpage_1
end type
type dw_alm_urg from datawindow within tabpage_1
end type
type dw_alm_hosp from datawindow within tabpage_1
end type
type dw_alm_amb from datawindow within tabpage_1
end type
type gb_5 from groupbox within tabpage_1
end type
type tabpage_1 from userobject within tab_1
tab_5 tab_5
st_24 st_24
st_20 st_20
st_10 st_10
st_9 st_9
st_39 st_39
d_ting d_ting
cbx_rf cbx_rf
cbx_pideprof cbx_pideprof
cbx_muevek cbx_muevek
cb_6 cb_6
cb_5 cb_5
dw_3 dw_3
st_8 st_8
dw_2 dw_2
dw_1 dw_1
st_7 st_7
st_6 st_6
gb_2 gb_2
dw_alm_cext dw_alm_cext
dw_alm_urg dw_alm_urg
dw_alm_hosp dw_alm_hosp
dw_alm_amb dw_alm_amb
gb_5 gb_5
end type
type tab_mipres from userobject within tab_1
end type
type sle_mptoken from singlelineedit within tab_mipres
end type
type st_token from statictext within tab_mipres
end type
type tab_7 from tab within tab_mipres
end type
type tabodbc from userobject within tab_7
end type
type st_17 from statictext within tabodbc
end type
type ddlb_modbc from dropdownlistbox within tabodbc
end type
type cb_9 from commandbutton within tabodbc
end type
type sle_musodbc from singlelineedit within tabodbc
end type
type st_16 from statictext within tabodbc
end type
type sle_mpsodbc from singlelineedit within tabodbc
end type
type st_5 from statictext within tabodbc
end type
type tabodbc from userobject within tab_7
st_17 st_17
ddlb_modbc ddlb_modbc
cb_9 cb_9
sle_musodbc sle_musodbc
st_16 st_16
sle_mpsodbc sle_mpsodbc
st_5 st_5
end type
type tabpage_syb from userobject within tab_7
end type
type st_31 from statictext within tabpage_syb
end type
type sle_misersyb from singlelineedit within tabpage_syb
end type
type st_30 from statictext within tabpage_syb
end type
type sle_miususyb from singlelineedit within tabpage_syb
end type
type st_25 from statictext within tabpage_syb
end type
type sle_mibdsyb from singlelineedit within tabpage_syb
end type
type st_19 from statictext within tabpage_syb
end type
type sle_mipssyb from singlelineedit within tabpage_syb
end type
type st_18 from statictext within tabpage_syb
end type
type ddlb_misyb from dropdownlistbox within tabpage_syb
end type
type tabpage_syb from userobject within tab_7
st_31 st_31
sle_misersyb sle_misersyb
st_30 st_30
sle_miususyb sle_miususyb
st_25 st_25
sle_mibdsyb sle_mibdsyb
st_19 st_19
sle_mipssyb sle_mipssyb
st_18 st_18
ddlb_misyb ddlb_misyb
end type
type tabole from userobject within tab_7
end type
type cbx_7 from checkbox within tabole
end type
type st_56 from statictext within tabole
end type
type ddlb_mole from dropdownlistbox within tabole
end type
type st_32 from statictext within tabole
end type
type sle_olemps from singlelineedit within tabole
end type
type cb_11 from commandbutton within tabole
end type
type tabole from userobject within tab_7
cbx_7 cbx_7
st_56 st_56
ddlb_mole ddlb_mole
st_32 st_32
sle_olemps sle_olemps
cb_11 cb_11
end type
type tab_7 from tab within tab_mipres
tabodbc tabodbc
tabpage_syb tabpage_syb
tabole tabole
end type
type cbx_mipres from checkbox within tab_mipres
end type
type tab_mipres from userobject within tab_1
sle_mptoken sle_mptoken
st_token st_token
tab_7 tab_7
cbx_mipres cbx_mipres
end type
type tab_1 from tab within w_para_grales_new
tp_gral tp_gral
tabpage_1 tabpage_1
tab_mipres tab_mipres
end type
type sle_3 from singlelineedit within w_para_grales_new
end type
type st_13 from statictext within w_para_grales_new
end type
type em_3 from editmask within w_para_grales_new
end type
type rb_2 from radiobutton within w_para_grales_new
end type
type st_14 from statictext within w_para_grales_new
end type
type em_cont from editmask within w_para_grales_new
end type
type st_15 from statictext within w_para_grales_new
end type
type sle_5 from singlelineedit within w_para_grales_new
end type
type st_12 from statictext within w_para_grales_new
end type
type c_con from checkbox within w_para_grales_new
end type
type c_tes from checkbox within w_para_grales_new
end type
type st_7a from statictext within w_para_grales_new
end type
type em_con from editmask within w_para_grales_new
end type
type em_tes from editmask within w_para_grales_new
end type
type em_sum from editmask within w_para_grales_new
end type
type em_car from editmask within w_para_grales_new
end type
type em_act from editmask within w_para_grales_new
end type
type em_nom from editmask within w_para_grales_new
end type
type em_cos from editmask within w_para_grales_new
end type
type em_pre from editmask within w_para_grales_new
end type
type c_pre from checkbox within w_para_grales_new
end type
type c_cos from checkbox within w_para_grales_new
end type
type c_nom from checkbox within w_para_grales_new
end type
type c_act from checkbox within w_para_grales_new
end type
type c_car from checkbox within w_para_grales_new
end type
type c_sum from checkbox within w_para_grales_new
end type
type gb_18 from groupbox within w_para_grales_new
end type
type gb_19 from groupbox within w_para_grales_new
end type
type ddlb_4 from dropdownlistbox within w_para_grales_new
end type
type gb_8 from groupbox within w_para_grales_new
end type
type gb_4 from groupbox within w_para_grales_new
end type
end forward

global type w_para_grales_new from window
integer width = 4942
integer height = 2100
boolean titlebar = true
string title = "Parámetros generales de la aplicación en este Computador"
boolean controlmenu = true
boolean minbox = true
windowtype windowtype = popup!
windowstate windowstate = maximized!
long backcolor = 67108864
string icon = "ribon_param.ico"
boolean clientedge = true
boolean center = true
rb_1 rb_1
cb_7 cb_7
pb_2 pb_2
pb_1 pb_1
ilim_pres ilim_pres
ilim_cost ilim_cost
ilim_nomi ilim_nomi
ilim_acti ilim_acti
ilim_cart ilim_cart
ilim_sumi ilim_sumi
ilim_teso ilim_teso
ilim_conta ilim_conta
ilim_asis ilim_asis
st_37 st_37
sle_vers_adm sle_vers_adm
sle_vers_as sle_vers_as
st_36 st_36
st_200 st_200
em_pres em_pres
em_cost em_cost
em_nomi em_nomi
em_acti em_acti
em_cart em_cart
em_sumi em_sumi
em_teso em_teso
em_2 em_2
gb_9 gb_9
c_asis c_asis
st_11 st_11
tab_1 tab_1
sle_3 sle_3
st_13 st_13
em_3 em_3
rb_2 rb_2
st_14 st_14
em_cont em_cont
st_15 st_15
sle_5 sle_5
st_12 st_12
c_con c_con
c_tes c_tes
st_7a st_7a
em_con em_con
em_tes em_tes
em_sum em_sum
em_car em_car
em_act em_act
em_nom em_nom
em_cos em_cos
em_pre em_pre
c_pre c_pre
c_cos c_cos
c_nom c_nom
c_act c_act
c_car c_car
c_sum c_sum
gb_18 gb_18
gb_19 gb_19
ddlb_4 ddlb_4
gb_8 gb_8
gb_4 gb_4
end type
global w_para_grales_new w_para_grales_new

type variables
boolean ya=false,i_cambio=false
string ls_enc='0'
u_version uo_ver
datawindowchild idw_almcext,idw_almcurg,idw_almhosp,idw_almcamb
end variables

on w_para_grales_new.create
this.rb_1=create rb_1
this.cb_7=create cb_7
this.pb_2=create pb_2
this.pb_1=create pb_1
this.ilim_pres=create ilim_pres
this.ilim_cost=create ilim_cost
this.ilim_nomi=create ilim_nomi
this.ilim_acti=create ilim_acti
this.ilim_cart=create ilim_cart
this.ilim_sumi=create ilim_sumi
this.ilim_teso=create ilim_teso
this.ilim_conta=create ilim_conta
this.ilim_asis=create ilim_asis
this.st_37=create st_37
this.sle_vers_adm=create sle_vers_adm
this.sle_vers_as=create sle_vers_as
this.st_36=create st_36
this.st_200=create st_200
this.em_pres=create em_pres
this.em_cost=create em_cost
this.em_nomi=create em_nomi
this.em_acti=create em_acti
this.em_cart=create em_cart
this.em_sumi=create em_sumi
this.em_teso=create em_teso
this.em_2=create em_2
this.gb_9=create gb_9
this.c_asis=create c_asis
this.st_11=create st_11
this.tab_1=create tab_1
this.sle_3=create sle_3
this.st_13=create st_13
this.em_3=create em_3
this.rb_2=create rb_2
this.st_14=create st_14
this.em_cont=create em_cont
this.st_15=create st_15
this.sle_5=create sle_5
this.st_12=create st_12
this.c_con=create c_con
this.c_tes=create c_tes
this.st_7a=create st_7a
this.em_con=create em_con
this.em_tes=create em_tes
this.em_sum=create em_sum
this.em_car=create em_car
this.em_act=create em_act
this.em_nom=create em_nom
this.em_cos=create em_cos
this.em_pre=create em_pre
this.c_pre=create c_pre
this.c_cos=create c_cos
this.c_nom=create c_nom
this.c_act=create c_act
this.c_car=create c_car
this.c_sum=create c_sum
this.gb_18=create gb_18
this.gb_19=create gb_19
this.ddlb_4=create ddlb_4
this.gb_8=create gb_8
this.gb_4=create gb_4
this.Control[]={this.rb_1,&
this.cb_7,&
this.pb_2,&
this.pb_1,&
this.ilim_pres,&
this.ilim_cost,&
this.ilim_nomi,&
this.ilim_acti,&
this.ilim_cart,&
this.ilim_sumi,&
this.ilim_teso,&
this.ilim_conta,&
this.ilim_asis,&
this.st_37,&
this.sle_vers_adm,&
this.sle_vers_as,&
this.st_36,&
this.st_200,&
this.em_pres,&
this.em_cost,&
this.em_nomi,&
this.em_acti,&
this.em_cart,&
this.em_sumi,&
this.em_teso,&
this.em_2,&
this.gb_9,&
this.c_asis,&
this.st_11,&
this.tab_1,&
this.sle_3,&
this.st_13,&
this.em_3,&
this.rb_2,&
this.st_14,&
this.em_cont,&
this.st_15,&
this.sle_5,&
this.st_12,&
this.c_con,&
this.c_tes,&
this.st_7a,&
this.em_con,&
this.em_tes,&
this.em_sum,&
this.em_car,&
this.em_act,&
this.em_nom,&
this.em_cos,&
this.em_pre,&
this.c_pre,&
this.c_cos,&
this.c_nom,&
this.c_act,&
this.c_car,&
this.c_sum,&
this.gb_18,&
this.gb_19,&
this.ddlb_4,&
this.gb_8,&
this.gb_4}
end on

on w_para_grales_new.destroy
destroy(this.rb_1)
destroy(this.cb_7)
destroy(this.pb_2)
destroy(this.pb_1)
destroy(this.ilim_pres)
destroy(this.ilim_cost)
destroy(this.ilim_nomi)
destroy(this.ilim_acti)
destroy(this.ilim_cart)
destroy(this.ilim_sumi)
destroy(this.ilim_teso)
destroy(this.ilim_conta)
destroy(this.ilim_asis)
destroy(this.st_37)
destroy(this.sle_vers_adm)
destroy(this.sle_vers_as)
destroy(this.st_36)
destroy(this.st_200)
destroy(this.em_pres)
destroy(this.em_cost)
destroy(this.em_nomi)
destroy(this.em_acti)
destroy(this.em_cart)
destroy(this.em_sumi)
destroy(this.em_teso)
destroy(this.em_2)
destroy(this.gb_9)
destroy(this.c_asis)
destroy(this.st_11)
destroy(this.tab_1)
destroy(this.sle_3)
destroy(this.st_13)
destroy(this.em_3)
destroy(this.rb_2)
destroy(this.st_14)
destroy(this.em_cont)
destroy(this.st_15)
destroy(this.sle_5)
destroy(this.st_12)
destroy(this.c_con)
destroy(this.c_tes)
destroy(this.st_7a)
destroy(this.em_con)
destroy(this.em_tes)
destroy(this.em_sum)
destroy(this.em_car)
destroy(this.em_act)
destroy(this.em_nom)
destroy(this.em_cos)
destroy(this.em_pre)
destroy(this.c_pre)
destroy(this.c_cos)
destroy(this.c_nom)
destroy(this.c_act)
destroy(this.c_car)
destroy(this.c_sum)
destroy(this.gb_18)
destroy(this.gb_19)
destroy(this.ddlb_4)
destroy(this.gb_8)
destroy(this.gb_4)
end on

event close;if not isvalid(w_principal) then halt
end event

type rb_1 from radiobutton within w_para_grales_new
integer x = 110
integer y = 440
integer width = 343
integer height = 72
integer taborder = 50
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Definitiva"
boolean checked = true
end type

event clicked;em_2.visible=false
st_14.visible=false
end event

type cb_7 from picturebutton within w_para_grales_new
integer x = 923
integer y = 1788
integer width = 146
integer height = 128
integer taborder = 450
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
boolean originalsize = true
string picturename = "refrescar.GIF"
alignment htextalign = left!
string powertiptext = "Cambiar"
end type

event clicked;open(w_cambia_clave)
end event

type pb_2 from picturebutton within w_para_grales_new
integer x = 3255
integer y = 1836
integer width = 146
integer height = 128
integer taborder = 480
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
boolean originalsize = true
string picturename = "cancelar.GIF"
string disabledname = "d_cancelar.GIF"
alignment htextalign = left!
string powertiptext = "Cerrar Ventana"
end type

event clicked;close(parenT)
end event

type pb_1 from picturebutton within w_para_grales_new
string tag = "&Guardar"
integer x = 3067
integer y = 1836
integer width = 146
integer height = 128
integer taborder = 470
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
boolean originalsize = true
string picturename = "guardar.GIF"
alignment htextalign = left!
end type

event clicked;string l_lice,l_nom_regis,l_activacion,l_aplicativo,esta,val_hast,cual

if c_con.checked and long(em_con.text)<=0 then
	messagebox("Atención","Digite el número de Licencias de Contabilidad")
	em_con.setfocus()
	return
end if
if c_tes.checked and long(em_tes.text)<=0 then
	messagebox("Atención","Digite el número de Licencias de Tesorería")
	em_tes.setfocus()
	return
end if
if c_sum.checked and long(em_sum.text)<=0 then
	messagebox("Atención","Digite el número de Licencias de Suministros")
	em_sum.setfocus()
	return
end if
if c_car.checked and long(em_car.text)<=0 then
	messagebox("Atención","Digite el número de Licencias de Cartera")
	em_car.setfocus()
	return
end if
if c_act.checked and long(em_act.text)<=0 then
	messagebox("Atención","Digite el número de Licencias de Activos Fijos")
	em_act.setfocus()
	return
end if
if c_nom.checked and long(em_nom.text)<=0 then
	messagebox("Atención","Digite el número de Licencias de Nómina")
	em_nom.setfocus()
	return
end if
if c_cos.checked and long(em_cos.text)<=0 then
	messagebox("Atención","Digite el número de Licencias de Costos")
	em_cos.setfocus()
	return
end if
if c_pre.checked and long(em_pre.text)<=0 then
	messagebox("Atención","Digite el número de Licencias de Presupuesto")
	em_pre.setfocus()
	return
end if
if c_asis.checked and long(em_3.text)<=0 then
	messagebox("Atención","Digite el número de Licencias Asistenciales")
	em_3.setfocus()
	return
end if
l_nom_regis=sle_3.text
esta=l_nom_regis
if c_asis.checked then
	l_lice=em_3.text
	l_aplicativo=ddlb_4.text
	choose case l_aplicativo
		case "CONSULTORIO"
			cual="1"
		case "APOYO DIAGNOSTICO"
			cual="2"
		case "ESPECIALISTA"
			cual="3"
		case "CONSULTA EXTERNA"
			cual="4"
		case "CLINICA"
			cual="5"
		case "HOSPITAL"
			cual="6"
		case "ODONTOLOGIA"
			cual="7"
		case "CONSULTORIO + APIDOCKER"
			cual="8"
		case "APOYO DIAGNOSTICO + APIDOCKER"
			cual="9"
		case "ESPECIALISTA + APIDOCKER"
			cual="10"
		case "CONSULTA EXTERNA + APIDOCKER"
			cual="11"
		case "CLINICA + APIDOCKER"
			cual="12"
		case "HOSPITAL + APIDOCKER"
			cual="13"
		case "ODONTOLOGIA + APIDOCKER"
			cual="14"			
	end choose
	l_aplicativo=cual
	esta+=l_lice+l_aplicativo
	esta+=left(trim(sle_vers_as.text),5)
else
	l_lice='0'
end if
l_activacion=sle_5.text
val_hast=em_2.text

if rb_2.checked then esta+=val_hast
string temp='0'
if c_con.checked then temp=em_con.text
esta+=temp
if c_con.checked and em_cont.text<>"0000/00" then esta+=em_cont.text
temp='0'
if c_tes.checked then temp=em_tes.text
esta+=temp
if c_tes.checked and em_teso.text<>"0000/00" then esta+=em_teso.text
temp='0'
if c_sum.checked then temp=em_sum.text
esta+=temp
if c_sum.checked and em_sumi.text<>"0000/00" then esta+=em_sumi.text
temp='0'
if c_car.checked then temp=em_car.text
esta+=temp
if c_car.checked and em_cart.text<>"0000/00" then esta+=em_cart.text
temp='0'
if c_act.checked then temp=em_act.text
esta+=temp
if c_act.checked and em_acti.text<>"0000/00" then esta+=em_acti.text
temp='0'
if c_nom.checked then temp=em_nom.text
esta+=temp
if c_nom.checked and em_nomi.text<>"0000/00" then esta+=em_nomi.text
temp='0'
if c_cos.checked then temp=em_cos.text
esta+=temp
if c_cos.checked and em_cost.text<>"0000/00" then esta+=em_cost.text
temp='0'
if c_pre.checked then temp=em_pre.text
esta+=temp
if c_pre.checked and em_pres.text<>"0000/00" then esta+=em_pres.text
if c_con.checked or c_tes.checked or c_sum.checked or c_car.checked or c_act.checked or c_nom.checked or c_cos.checked or c_pre.checked then esta+=left(trim(sle_vers_adm.text),5)
if f_checksum(esta,(l_activacion))=false then
	messagebox("Error","La clave no es válida para los parámetros que tiene")
	return 
end if

string DBPARM,lugar,areaadx,profe
lugar=tab_1.tabpage_1.dw_3.getitemstring(1,1)
areaadx=tab_1.tabpage_1.dw_1.getitemstring(1,1)
profe=tab_1.tabpage_1.dw_2.getitemstring(1,1)
string dbparm2
dbparm2="ConnectOption=' SQL_DRIVER_CONNECT , SQL_DRIVER_NOPROMPT '"
choose case tab_1.tp_gral.tab_2.selectedtab
	case 1//odbc
		if tab_1.tp_gral.tab_2.tp_1.ddlb_1.text="" then
			messagebox("Atención","Debe escoger el tipo DSN a utilizar")
			return
		end if
		DBPARM="ConnectString ='DSN="+tab_1.tp_gral.tab_2.tp_1.ddlb_1.text+";UID="
		
		if ls_pro=32 then
			RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS", RegString!, 'ODBC' )
			RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM", RegString!, DBPARM )
			Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID", Regstring!, tab_1.tp_gral.tab_2.tp_1.sle_logidod.text )
			Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS", Regstring!, f_encripta(tab_1.tp_gral.tab_2.tp_1.sle_logpassod.text) )
		End if
		if ls_pro=64 then
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS", RegString!, 'ODBC' )
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM", RegString!, DBPARM )
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID", Regstring!, tab_1.tp_gral.tab_2.tp_1.sle_logidod.text )
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS", Regstring!, f_encripta(tab_1.tp_gral.tab_2.tp_1.sle_logpassod.text) )
		End If

case 2//sybase
		if ls_pro=32 then
			RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS", RegString!, 'SYC Adaptive Server Enterprise' )
			RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "SERVERNAME", Regstring!, tab_1.tp_gral.tab_2.tp_2.sle_serv.text )
			Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DATABASE", Regstring!, tab_1.tp_gral.tab_2.tp_2.sle_bd.text )
			Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID", Regstring!, tab_1.tp_gral.tab_2.tp_2.sle_logid.text )
			Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS", Regstring!, f_encripta(tab_1.tp_gral.tab_2.tp_2.sle_logpass.text) )
		End if
		if ls_pro=64 then
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS", RegString!, 'SYC Adaptive Server Enterprise' )
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "SERVERNAME", Regstring!, tab_1.tp_gral.tab_2.tp_2.sle_serv.text )
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DATABASE", Regstring!, tab_1.tp_gral.tab_2.tp_2.sle_bd.text )
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID", Regstring!, tab_1.tp_gral.tab_2.tp_2.sle_logid.text )
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS", Regstring!, f_encripta(tab_1.tp_gral.tab_2.tp_2.sle_logpass.text) )
		End If

		if tab_1.tp_gral.tab_2.tp_2.ddlb_2.text='' then
			messagebox("Atención","Debe escoger la versión ASE")
			return
		end if
		dbparm2+=",release='"+tab_1.tp_gral.tab_2.tp_2.ddlb_2.text+"'"
	case 3//ole db
		if tab_1.tp_gral.tab_2.tp_ole.sle_6.text='' then 
			messagebox("Atención","Debe escoger el archivo de conexión")
			return
		end if
		if ls_pro=32 then
			RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS", RegString!, 'OLE DB' )
			RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_PROVIDER", Regstring!, tab_1.tp_gral.tab_2.tp_ole.ddlb_3.text )
			RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_FILE", Regstring!, tab_1.tp_gral.tab_2.tp_ole.sle_6.text )
		End if
		if ls_pro=64 then
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS", RegString!, 'OLE DB' )
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_PROVIDER", Regstring!, tab_1.tp_gral.tab_2.tp_ole.ddlb_3.text )
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_FILE", Regstring!, tab_1.tp_gral.tab_2.tp_ole.sle_6.text )
		End If
end choose
if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM2",dbparm2)
End If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM2",dbparm2)
End If

/////INCIO CAPITADOS
if tab_1.tabpage_1.tab_5.tabpage_4.cbx_3.checked then
	string dbparm2_capi
	dbparm2_capi="ConnectOption=' SQL_DRIVER_CONNECT , SQL_DRIVER_NOPROMPT '"
	if ls_pro=32 then
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "BASE_CAPI", RegString!, '1' )
	End If
	if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "BASE_CAPI", RegString!, '1' )
	End If
	choose case tab_1.tabpage_1.tab_5.tabpage_4.tab_3.selectedtab
		case 1//odbc
			if tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_6.ddlb_5.text="" then
				messagebox("Atención","Debe escoger el tipo DSN a utilizar para la base capitada")
				return
			end if
			DBPARM="ConnectString ='DSN="+tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_6.ddlb_5.text+";UID="
			if ls_pro=32 then
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_CAPI", RegString!, 'ODBC' )
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM_CAPI", RegString!, DBPARM )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_CAPI", Regstring!, tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_6.sle_4.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_CAPI", Regstring!, f_encripta(tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_6.sle_capi_pas_od.text) )
			End If
			if ls_pro=64 then
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_CAPI", RegString!, 'ODBC' )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM_CAPI", RegString!, DBPARM )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_CAPI", Regstring!, tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_6.sle_4.text )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_CAPI", Regstring!, f_encripta(tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_6.sle_capi_pas_od.text) )
			End If

		case 2//sybase
			if ls_pro=32 then	
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_CAPI", RegString!, 'SYC Adaptive Server Enterprise' )
				RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "SERVERNAME_CAPI", Regstring!,tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_7.sle_8.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DATABASE_CAPI", Regstring!, tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_7.sle_9.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_CAPI", Regstring!, tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_7.sle_10.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_CAPI", Regstring!, f_encripta(tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_7.sle_capi_pas_syb.text) )
			End If
			if ls_pro=64 then
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_CAPI", RegString!, 'SYC Adaptive Server Enterprise' )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "SERVERNAME_CAPI", Regstring!,tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_7.sle_8.text)
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DATABASE_CAPI", Regstring!, tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_7.sle_9.text )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_CAPI", Regstring!, tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_7.sle_10.text )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_CAPI", Regstring!, f_encripta(tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_7.sle_capi_pas_syb.text) )
			end If
			if tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_7.ddlb_7.text='' then
				messagebox("Atención","Debe escoger la versión ASE de la base capitada")
				return
			end if
			dbparm2_capi+=",release='"+tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_7.ddlb_7.text+"'"

		case 3//ole db
			if tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_8.sle_con.text='' then 
				messagebox("Atención","Debe escoger el archivo de conexión OLE de la base Capitada")
				return
			end if
			if ls_pro=32 then	
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_CAPI", RegString!, 'OLE DB' )
				RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_PROVIDER_CAPI", Regstring!, tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_8.ddlb_6.text )
				RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_FILE_CAPI", Regstring!,tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_8.sle_con.text )
			End If
			if ls_pro=64 then
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_CAPI", RegString!, 'OLE DB' )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "PROVIDER_CAPI", Regstring!, tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_8.ddlb_6.text )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_FILE_CAPI", Regstring!, tab_1.tabpage_1.tab_5.tabpage_4.tab_3.tabpage_8.sle_con.text )
			end if
   end choose
   if ls_pro=32 then	
   		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM2_CAPI",dbparm2_capi)
   End If
   if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM2_CAPI",dbparm2_capi)
   End If
else
   	if ls_pro=32 then
		Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DATABASE_CAPI", Regstring!,'')
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "BASE_CAPI", RegString!,'0')
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_CAPI", RegString!,'')
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM_CAPI", RegString!,'')
		Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_CAPI", Regstring!,'')
		Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_CAPI", Regstring!,'')	
		RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_PROVIDER_CAPI", Regstring!,'')
		RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_FILE_CAPI", Regstring!,'')
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM2_CAPI",'')
		RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "SERVERNAME_CAPI", Regstring!,'')		
   End If
   if ls_pro=64 then
		Registryset ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DATABASE_CAPI", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "BASE_CAPI", RegString!, '0' )
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_CAPI", RegString!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM_CAPI", RegString!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_CAPI", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_CAPI", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "PROVIDER_CAPI", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_FILE_CAPI", Regstring!,'')	
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM2_CAPI",'')		
		RegistrySet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "SERVERNAME_CAPI", Regstring!,'')		
		
  	 End If
end if
/////FIN CAPITADOS

///////INICIO EQUIPOS
if tab_1.tabpage_1.tab_5.tabpage_5.cbx_5.checked then
	string dbparm2_equ
	dbparm2_equ="ConnectOption=' SQL_DRIVER_CONNECT , SQL_DRIVER_NOPROMPT '"
	if ls_pro=32 then
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "BASE_EQU", RegString!, '1' )
	End If
	if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "BASE_EQU", RegString!, '1' )
	End If
	choose case tab_1.tabpage_1.tab_5.tabpage_5.tab_6.selectedtab
		case 1//odbc
			if tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_9.ddlb_8.text="" then
				messagebox("Atención","Debe escoger el tipo DSN a utilizar para la base equipos")
				return
			end if
			DBPARM="ConnectString ='DSN="+tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_9.ddlb_8.text+";UID="
			if ls_pro=32 then
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_EQU", RegString!, 'ODBC' )
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM_EQU", RegString!, DBPARM )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_EQU", Regstring!, tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_9.sle_11.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_EQU", Regstring!, f_encripta(tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_9.sle_12.text) )
			End If
			if ls_pro=64 then
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_EQU", RegString!, 'ODBC' )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM_EQU", RegString!, DBPARM )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_EQU", Regstring!,tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_9.sle_11.text )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_EQU", Regstring!, f_encripta(tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_9.sle_12.text) )
			End If

		case 2//sybase
			if ls_pro=32 then	
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_EQU", RegString!, 'SYC Adaptive Server Enterprise' )
				RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "SERVERNAME_EQU", Regstring!,tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_10.sle_13.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DATABASE_EQU", Regstring!, tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_10.sle_14.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_EQU", Regstring!, tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_10.sle_15.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_EQU", Regstring!, f_encripta(tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_10.sle_16.text) )
			End If
			if ls_pro=64 then
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_EQU", RegString!, 'SYC Adaptive Server Enterprise' )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "SERVERNAME_EQU", Regstring!,tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_10.sle_13.text )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DATABASE_EQU", Regstring!, tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_10.sle_14.text )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_EQU", Regstring!, tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_10.sle_15.text  )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_EQU", Regstring!, f_encripta(tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_10.sle_16.text) )
			end If
			if tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_10.ddlb_9.text='' then
				messagebox("Atención","Debe escoger la versión ASE de la base equipos")
				return
			end if
			dbparm2_equ+=",release='"+tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_10.ddlb_9.text+"'"

		case 3//ole db
			if tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_11.ddlb_10.text='' then 
				messagebox("Atención","Debe escoger el archivo de conexión OLE de la base Equipos")
				return
			end if
			if ls_pro=32 then	
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_EQU", RegString!, 'OLE DB' )
				RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_PROVIDER_EQU", Regstring!, tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_11.ddlb_10.text )
				RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_FILE_EQU", Regstring!,tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_11.sle_17.text )
			End If
			if ls_pro=64 then
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_EQU", RegString!, 'OLE DB' )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "PROVIDER_EQU", Regstring!, tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_11.ddlb_10.text )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_FILE_EQU", Regstring!, tab_1.tabpage_1.tab_5.tabpage_5.tab_6.tabpage_11.sle_17.text )
			end if
   end choose
   if ls_pro=32 then	
   		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM2_EQU",dbparm2_equ)
   End If
   if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM2_EQU",dbparm2_equ)
   End If
else
   	if ls_pro=32 then
		Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DATABASE_EQU", Regstring!,'')
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "BASE_EQU", RegString!,'0')
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_EQU", RegString!,'')
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM_EQU", RegString!,'')
		Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_EQU", Regstring!,'')
		Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_EQU", Regstring!,'')	
		RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_PROVIDER_EQU", Regstring!,'')
		RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_FILE_EQU", Regstring!,'')
		RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM2_EQU",'')	
		RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "SERVERNAME_EQU", Regstring!,'')				
	end If
  	 if ls_pro=64 then
		Registryset ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DATABASE_EQU", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "BASE_EQU", RegString!, '0' )
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_EQU", RegString!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM_EQU", RegString!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_EQU", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_EQU", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "PROVIDER_EQU", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_FILE_EQU", Regstring!,'')	
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM2_EQU",'')	
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "SERVERNAME_EQU", Regstring!,'')				
  	 End If	
end if
/////////FIN EQUIPOS

//////////////////INCIO MIPRES
if tab_1.tab_mipres.cbx_mipres.checked then
	string dbparm2_mipres
	dbparm2_mipres="ConnectOption=' SQL_DRIVER_CONNECT , SQL_DRIVER_NOPROMPT '"
	if ls_pro=32 then
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "BASE_MIPRES", RegString!, '1' )
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "TOKEN_MIPRES", RegString!,f_encripta(tab_1.tab_mipres.sle_mptoken.text)) 
	End If
	if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "BASE_MIPRES", RegString!, '1' )
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "TOKEN_MIPRES", RegString!,f_encripta(tab_1.tab_mipres.sle_mptoken.text))
	End If
	choose case tab_1.tab_mipres.tab_7.selectedtab
		case 1//odbc
			if  tab_1.tab_mipres.tab_7.tabodbc.ddlb_modbc.text="" then
				messagebox("Atención","Debe escoger el tipo DSN a utilizar para la base mipres")
				return
			end if
			DBPARM="ConnectString ='DSN="+tab_1.tab_mipres.tab_7.tabodbc.ddlb_modbc.text+";UID="
			if ls_pro=32 then
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_MIPRES", RegString!, 'ODBC' )
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM_MIPRES", RegString!, DBPARM )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_MIPRES", Regstring!, tab_1.tab_mipres.tab_7.tabodbc.sle_musodbc.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_MIPRES", Regstring!, f_encripta(tab_1.tab_mipres.tab_7.tabodbc.sle_mpsodbc.text) )
			End If
			if ls_pro=64 then
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_MIPRES", RegString!, 'ODBC' )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM_MIPRES", RegString!, DBPARM )
				Registryset ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_MIPRES", Regstring!, tab_1.tab_mipres.tab_7.tabodbc.sle_musodbc.text )
				Registryset ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_MIPRES", Regstring!, f_encripta(tab_1.tab_mipres.tab_7.tabodbc.sle_mpsodbc.text) )			
			End If
		case 2//sybase
			if ls_pro=32 then	
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_MIPRES", RegString!, 'SYC Adaptive Server Enterprise' )
				RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "SERVERNAME_MIPRES", Regstring!,tab_1.tab_mipres.tab_7.tabpage_syb.sle_misersyb.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DATABASE_MIPRES", Regstring!,tab_1.tab_mipres.tab_7.tabpage_syb.sle_mibdsyb.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_MIPRES", Regstring!, tab_1.tab_mipres.tab_7.tabpage_syb.sle_miususyb.text )
				Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_MIPRES", Regstring!, f_encripta( tab_1.tab_mipres.tab_7.tabpage_syb.sle_mipssyb.text) )
			End If
			if ls_pro=64 then
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_MIPRES", RegString!, 'SYC Adaptive Server Enterprise' )
				RegistrySet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "SERVERNAME_MIPRES", Regstring!,tab_1.tab_mipres.tab_7.tabpage_syb.sle_misersyb.text )
				Registryset ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DATABASE_MIPRES", Regstring!,tab_1.tab_mipres.tab_7.tabpage_syb.sle_mibdsyb.text )
				Registryset ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_MIPRES", Regstring!, tab_1.tab_mipres.tab_7.tabpage_syb.sle_miususyb.text )
				Registryset ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_MIPRES", Regstring!, f_encripta( tab_1.tab_mipres.tab_7.tabpage_syb.sle_mipssyb.text))			
			end If
			if tab_1.tab_mipres.tab_7.tabpage_syb.ddlb_misyb.text='' then
				messagebox("Atención","Debe escoger la versión ASE de la base Mipres")
				return
			end if
			dbparm2_mipres+=",release='"+tab_1.tab_mipres.tab_7.tabpage_syb.ddlb_misyb.text+"'"

		case 3//ole db
			if tab_1.tab_mipres.tab_7.tabole.ddlb_mole.text='' then 
				messagebox("Atención","Debe escoger el archivo de conexión OLE de la base Mipres")
				return
			end if
			if ls_pro=32 then	
				RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_MIPRES", RegString!, 'OLE DB' )
				RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_PROVIDER_MIPRES", Regstring!, tab_1.tab_mipres.tab_7.tabole.ddlb_mole.text)
				RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_FILE_MIPRES", Regstring!,tab_1.tab_mipres.tab_7.tabole.sle_olemps.text )
			End If
			if ls_pro=64 then
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_MIPRES", RegString!, 'OLE DB' )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "PROVIDER_MIPRES", Regstring!,tab_1.tab_mipres.tab_7.tabole.ddlb_mole.text )
				RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_FILE_MIPRES", Regstring!, tab_1.tab_mipres.tab_7.tabole.sle_olemps.text )
			end if
   end choose
   if ls_pro=32 then	
   		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM2_MIPRES",dbparm2_mipres)
   End If
   if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM2_MIPRES",dbparm2_mipres)
   End If
else
   	if ls_pro=32 then
		Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DATABASE_MIPRES", Regstring!,'')
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "BASE_MIPRES", RegString!,'0')
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_MIPRES", RegString!,'')
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM_MIPRES", RegString!,'')
		Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_MIPRES", Regstring!,'')
		Registryset ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_MIPRES", Regstring!,'')	
		RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_PROVIDER_MIPRES", Regstring!,'')
		RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_FILE_MIPRES", Regstring!,'')
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM2_MIPRES",'')		
		RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "SERVERNAME_MIPRES", Regstring!,'')	
	end If
  	 if ls_pro=64 then
		Registryset ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DATABASE_MIPRES", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "BASE_MIPRES", RegString!, '0' )
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_MIPRES", RegString!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM_MIPRES", RegString!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_MIPRES", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_MIPRES", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "PROVIDER_MIPRES", Regstring!,'')
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_FILE_MIPRES", Regstring!,'')	
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM2_MIPRES",'')		
		RegistrySet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "SERVERNAME_MIPRES", Regstring!,'')				
  	 End If			
end if
///////FIN MIPRES
if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "CLIENTE", RegString!, l_nom_regis )
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "APLICATIVO", RegString!, l_aplicativo )
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "NROLICEN", RegString!, l_lice )
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "CLAVE", RegString!, f_encripta(l_activacion ))
end If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "CLIENTE", RegString!, l_nom_regis )
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "APLICATIVO", RegString!, l_aplicativo )
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "NROLICEN", RegString!, l_lice )
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "CLAVE", RegString!,  f_encripta(l_activacion) )
End If

if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DIRECTORIO", RegString!, tab_1.tp_gral.sle_1.text)
end If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "DIRECTORIO", RegString!, tab_1.tp_gral.sle_1.text)
end If

temp='0'
if c_con.checked then temp=em_con.text
if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_CONT", regstring!, temp)
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_CONT", regstring!, em_cont.text)
end If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_CONT", regstring!, temp)
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_CONT", regstring!, em_cont.text)
end If

temp='0'
if c_tes.checked then temp=em_tes.text
if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_TESO", regstring!, temp)
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_TESO", regstring!, em_teso.text)
end If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_TESO", regstring!, temp)
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_TESO", regstring!, em_teso.text)
end If

temp='0'
if c_sum.checked then temp=em_sum.text
if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_SUMI", regstring!, temp)
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_SUMI", regstring!, em_sumi.text)
end If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_SUMI", regstring!, temp)
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_SUMI", regstring!, em_sumi.text)
end If

temp='0'
if c_car.checked then temp=em_car.text
if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_CART", regstring!, temp)
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_CART", regstring!, em_cart.text)
end If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_CART", regstring!, temp)
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_CART", regstring!, em_cart.text)
end If

temp='0'
if c_act.checked then temp=em_act.text
if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_ACTI", regstring!, temp)
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_ACTI", regstring!, em_acti.text)
end If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_ACTI", regstring!, temp)
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_ACTI", regstring!, em_acti.text)
end If

temp='0'
if c_nom.checked then temp=em_nom.text
if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_NOMI", regstring!, temp)
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_NOMI", regstring!, em_nomi.text)
end If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_NOMI", regstring!, temp)
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_NOMI", regstring!, em_nomi.text)
end If

temp='0'
if c_cos.checked then temp=em_cos.text
if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_COST", regstring!, temp)
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_COST", regstring!, em_cost.text)
end If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_COST", regstring!, temp)
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_COST", regstring!, em_cost.text)
end If

temp='0'
if c_pre.checked then temp=em_pre.text
if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_PRES", regstring!, temp)
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_PRES", regstring!, em_pres.text)
end If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_PRES", regstring!, temp)
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_PRES", regstring!, em_pres.text)
end If

if rb_2.checked then //tempo o definitiva
	if ls_pro=32 then
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA", RegString!, "0000/00" )
	end If
	if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA", RegString!, "0000/00" )
	end If
else
	if ls_pro=32 then
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA", RegString!, val_hast )
	end If
	if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA", RegString!, val_hast )
	end If
end if

if ls_pro=32 then
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LUGAR", RegString!, lugar )
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "AREAAPDX", RegString!, areaadx )
	RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "PROFE", RegString!, profe )
end If
if ls_pro=64 then
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "LUGAR", RegString!, lugar )
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "AREAAPDX", RegString!, areaadx )
	RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "PROFE", RegString!, profe )
end If

choose case tab_1.tabpage_1.d_ting.text
	case 'URGENCIAS'
		if ls_pro=32 then
			RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "TINGRESO", Regstring!, '2')
		end If
		if ls_pro=64 then
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "TINGRESO", Regstring!, '2')
		end If
	case 'HOSPITALIZACIÓN'
		if ls_pro=32 then
			RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "TINGRESO", Regstring!, '3')
		end If
		if ls_pro=64 then
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "TINGRESO", Regstring!, '3')
		end If
	case 'AMBULATORIO'		
		if ls_pro=32 then
			RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "TINGRESO", Regstring!, '4')
		end If
		if ls_pro=64 then
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "TINGRESO", Regstring!, '4')
		end If
	case 'UCI'
		if ls_pro=32 then
			RegistrySet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "TINGRESO", Regstring!, '7')
		end If
		if ls_pro=64 then
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "TINGRESO", Regstring!, '7')
		end If
end choose

if tab_1.tabpage_1.cbx_pideprof.checked then
	if ls_pro=32 then
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "PIDEPROF", RegString!, "1" )
	end If
	if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "PIDEPROF", RegString!, "1" )
	end If
else
	if ls_pro=32 then
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "PIDEPROF", RegString!, "0" )
	end If
	if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "PIDEPROF", RegString!, "0" )
	end If
end if

if tab_1.tabpage_1.cbx_RF.checked then
	if ls_pro=32 then
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "RIPS_AL_FACTURAR",RegString!,'1')
	end If
	if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "RIPS_AL_FACTURAR",RegString!,'1')
	end If
else
	if ls_pro=32 then
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "RIPS_AL_FACTURAR",RegString!,'0')
	end If
	if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "RIPS_AL_FACTURAR",RegString!,'0')
	end If
end if

if tab_1.tabpage_1.cbx_muevek.checked then
	if ls_pro=32 then
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "MUEVE_KARDEX", RegString!, "1" )
	end If
	if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "MUEVE_KARDEX", RegString!, "1" )
	end If

	string alm
	alm=tab_1.tabpage_1.dw_alm_cext.getitemstring(1,1)
	if not isnull(alm) and alm<>"" then 
		if ls_pro=32 then
			RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\SUMINISTROS", "ALM_CEXT", RegString!, alm )
		end If
		if ls_pro=64 then
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\SUMINISTROS", "ALM_CEXT", RegString!, alm )
		end If
	end if
	alm=tab_1.tabpage_1.dw_alm_urg.getitemstring(1,1)

	if not isnull(alm) and alm<>"" then 
		if ls_pro=32 then
			RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\SUMINISTROS", "ALM_URG", RegString!, alm )
		end If
		if ls_pro=64 then
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\SUMINISTROS", "ALM_URG", RegString!, alm )
		end If
	end if
	alm=tab_1.tabpage_1.dw_alm_hosp.getitemstring(1,1)
	
	if not isnull(alm) and alm<>"" then 
		if ls_pro=32 then
			RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\SUMINISTROS", "ALM_HOSP", RegString!, alm )
		end If
		if ls_pro=64 then
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\SUMINISTROS", "ALM_HOSP", RegString!, alm )
		end If
	end if
	alm=tab_1.tabpage_1.dw_alm_amb.getitemstring(1,1)
	
	if not isnull(alm) and alm<>"" then 
		if ls_pro=32 then
			RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\SUMINISTROS", "ALM_AMB", RegString!, alm )
		end If
		if ls_pro=64 then
			RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\SUMINISTROS", "ALM_AMB", RegString!, alm )
		end If
	end if
else
	if ls_pro=32 then
		RegistrySet ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "MUEVE_KARDEX", RegString!, "0" )
	end If
	if ls_pro=64 then
		RegistrySet ( "HKEY_CURRENT_USER\SOFTWARE\GCI\", "MUEVE_KARDEX", RegString!, "0" )
	end If
end if
end event

type ilim_pres from checkbox within w_para_grales_new
integer x = 741
integer y = 1492
integer width = 192
integer height = 64
integer taborder = 410
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Ilimit."
end type

event clicked;if checked then
	em_pre.text='1000'
	em_pre.visible=false
else
	em_pre.text='2'
	em_pre.visible=true
end if
end event

type ilim_cost from checkbox within w_para_grales_new
integer x = 741
integer y = 1404
integer width = 192
integer height = 64
integer taborder = 370
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Ilimit."
end type

event clicked;if checked then
	em_cos.text='1000'
	em_cos.visible=false
else
	em_cos.text='2'
	em_cos.visible=true
end if
end event

type ilim_nomi from checkbox within w_para_grales_new
integer x = 741
integer y = 1320
integer width = 192
integer height = 64
integer taborder = 330
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Ilimit."
end type

event clicked;if checked then
	em_nom.text='1000'
	em_nom.visible=false
else
	em_nom.text='2'
	em_nom.visible=true
end if
end event

type ilim_acti from checkbox within w_para_grales_new
integer x = 741
integer y = 1236
integer width = 192
integer height = 64
integer taborder = 290
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Ilimit."
end type

event clicked;if checked then
	em_act.text='1000'
	em_act.visible=false
else
	em_act.text='2'
	em_act.visible=true
end if
end event

type ilim_cart from checkbox within w_para_grales_new
integer x = 741
integer y = 1152
integer width = 192
integer height = 64
integer taborder = 250
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Ilimit."
end type

event clicked;if checked then
	em_car.text='1000'
	em_car.visible=false
else
	em_car.text='2'
	em_car.visible=true
end if
end event

type ilim_sumi from checkbox within w_para_grales_new
integer x = 741
integer y = 1068
integer width = 192
integer height = 64
integer taborder = 210
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Ilimit."
end type

event clicked;if checked then
	em_sum.text='1000'
	em_sum.visible=false
else
	em_sum.text='2'
	em_sum.visible=true
end if
end event

type ilim_teso from checkbox within w_para_grales_new
integer x = 741
integer y = 984
integer width = 192
integer height = 64
integer taborder = 170
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Ilimit."
end type

event clicked;if checked then
	em_tes.text='1000'
	em_tes.visible=false
else
	em_tes.text='2'
	em_tes.visible=true
end if
end event

type ilim_conta from checkbox within w_para_grales_new
integer x = 741
integer y = 900
integer width = 192
integer height = 64
integer taborder = 130
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Ilimit."
end type

event clicked;if checked then
	em_con.text='1000'
	em_con.visible=false
else
	em_con.text='2'
	em_con.visible=true
end if
end event

type ilim_asis from checkbox within w_para_grales_new
integer x = 942
integer y = 504
integer width = 197
integer height = 64
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Ilimit."
end type

event clicked;if checked then
	em_3.text='1000'
	em_3.visible=false
else
	em_3.text='2'
	em_3.visible=true
end if
end event

type st_37 from statictext within w_para_grales_new
integer x = 133
integer y = 1592
integer width = 197
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Versión:"
boolean focusrectangle = false
end type

type sle_vers_adm from singlelineedit within w_para_grales_new
integer x = 539
integer y = 1584
integer width = 242
integer height = 80
integer taborder = 430
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "2.0.0.1"
borderstyle borderstyle = stylelowered!
end type

event constructor;if not isvalid(uo_ver) then
	uo_ver=create u_version
end if
text=uo_ver.i_version_adm
end event

type sle_vers_as from singlelineedit within w_para_grales_new
integer x = 1243
integer y = 448
integer width = 261
integer height = 76
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "3.0.1.0"
borderstyle borderstyle = stylelowered!
end type

event constructor;if not isvalid(uo_ver) then
	uo_ver=create u_version
end if
text=uo_ver.i_version_asis
end event

type st_36 from statictext within w_para_grales_new
integer x = 1253
integer y = 516
integer width = 197
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Versión:"
boolean focusrectangle = false
end type

type st_200 from statictext within w_para_grales_new
integer x = 987
integer y = 844
integer width = 293
integer height = 56
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Válida Hasta"
boolean focusrectangle = false
end type

type em_pres from editmask within w_para_grales_new
integer x = 983
integer y = 1492
integer width = 297
integer height = 72
integer taborder = 420
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "0000/00"
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = datemask!
string mask = "yyyy/mm"
boolean spin = true
double increment = 1
string minmax = "2001/01~~2100/12"
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_PRES", Regstring!, this.text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_PRES", Regstring!, this.text )

end event

type em_cost from editmask within w_para_grales_new
integer x = 983
integer y = 1404
integer width = 297
integer height = 72
integer taborder = 380
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "0000/00"
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = datemask!
string mask = "yyyy/mm"
boolean spin = true
double increment = 1
string minmax = "2001/01~~2100/12"
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_COST", Regstring!, this.text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_COST", Regstring!, this.text )

end event

type em_nomi from editmask within w_para_grales_new
integer x = 983
integer y = 1320
integer width = 297
integer height = 72
integer taborder = 340
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "0000/00"
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = datemask!
string mask = "yyyy/mm"
boolean spin = true
double increment = 1
string minmax = "2001/01~~2100/12"
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_NOMI", Regstring!, this.text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_NOMI", Regstring!, this.text )
end event

type em_acti from editmask within w_para_grales_new
integer x = 983
integer y = 1236
integer width = 297
integer height = 72
integer taborder = 300
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "0000/00"
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = datemask!
string mask = "yyyy/mm"
boolean spin = true
double increment = 1
string minmax = "2001/01~~2100/12"
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_ACTI", Regstring!, this.text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_ACTI", Regstring!, this.text )
end event

type em_cart from editmask within w_para_grales_new
integer x = 983
integer y = 1152
integer width = 297
integer height = 72
integer taborder = 260
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "0000/00"
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = datemask!
string mask = "yyyy/mm"
boolean spin = true
double increment = 1
string minmax = "2001/01~~2100/12"
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_CART", Regstring!, this.text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_CART", Regstring!, this.text )

end event

type em_sumi from editmask within w_para_grales_new
integer x = 983
integer y = 1068
integer width = 297
integer height = 72
integer taborder = 220
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "0000/00"
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = datemask!
string mask = "yyyy/mm"
boolean spin = true
double increment = 1
string minmax = "2001/01~~2100/12"
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_SUMI", Regstring!, this.text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_SUMI", Regstring!, this.text )

end event

type em_teso from editmask within w_para_grales_new
integer x = 983
integer y = 984
integer width = 297
integer height = 72
integer taborder = 180
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "0000/00"
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = datemask!
string mask = "yyyy/mm"
boolean spin = true
double increment = 1
string minmax = "2001/01~~2100/12"
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_TESO", Regstring!, this.text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_TESO", Regstring!, this.text )

end event

type em_2 from editmask within w_para_grales_new
integer x = 933
integer y = 588
integer width = 283
integer height = 84
integer taborder = 70
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "2004/01"
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = datemask!
string mask = "yyyy/mm"
boolean spin = true
double increment = 1
string minmax = "2001/01~~2100/12"
end type

event constructor;if ls_pro=32 then 	RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA", Regstring!, this.text )
if ls_pro=64 then	RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA", Regstring!, this.text )
if this.text="0000/00" then
	this.visible=false
	st_14.visible=false
	rb_1.checked=true
else
	rb_2.checked=true
end if
end event

type gb_9 from groupbox within w_para_grales_new
integer x = 78
integer y = 772
integer width = 1481
integer height = 960
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Módulos Administrativos"
end type

type c_asis from checkbox within w_para_grales_new
integer x = 110
integer y = 184
integer width = 503
integer height = 72
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Módulo Asistencial"
boolean checked = true
end type

event clicked;if this.checked then 
	ddlb_4.enabled=true
	em_3.enabled=true
	tab_1.tabpage_1.enabled=true
else
	ddlb_4.enabled=false
	em_3.enabled=false
	tab_1.tabpage_1.enabled=false
end if
end event

event constructor;string temp
if ls_pro=32 then Registryget ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "NROLICEN", regstring!, temp)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "NROLICEN", regstring!, temp)
if long(temp)>0 then
	this.checked=true
	em_3.text='0'
else
	this.checked=false
end if
this.triggerevent(clicked!)
end event

type st_11 from statictext within w_para_grales_new
integer x = 69
integer y = 104
integer width = 165
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Cliente:"
boolean focusrectangle = false
end type

type tab_1 from tab within w_para_grales_new
integer x = 1650
integer y = 60
integer width = 2971
integer height = 1764
integer taborder = 460
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long backcolor = 67108864
boolean multiline = true
boolean raggedright = true
boolean focusonbuttondown = true
boolean powertips = true
boolean boldselectedtext = true
alignment alignment = center!
integer selectedtab = 1
tp_gral tp_gral
tabpage_1 tabpage_1
tab_mipres tab_mipres
end type

on tab_1.create
this.tp_gral=create tp_gral
this.tabpage_1=create tabpage_1
this.tab_mipres=create tab_mipres
this.Control[]={this.tp_gral,&
this.tabpage_1,&
this.tab_mipres}
end on

on tab_1.destroy
destroy(this.tp_gral)
destroy(this.tabpage_1)
destroy(this.tab_mipres)
end on

type tp_gral from userobject within tab_1
integer x = 18
integer y = 112
integer width = 2935
integer height = 1636
long backcolor = 67108864
string text = "Generales"
long tabtextcolor = 33554432
string picturename = "rep.ico"
long picturemaskcolor = 536870912
string powertiptext = "Generales de la Aplicación"
tab_4 tab_4
sle_1 sle_1
st_1 st_1
tab_2 tab_2
gb_1 gb_1
end type

on tp_gral.create
this.tab_4=create tab_4
this.sle_1=create sle_1
this.st_1=create st_1
this.tab_2=create tab_2
this.gb_1=create gb_1
this.Control[]={this.tab_4,&
this.sle_1,&
this.st_1,&
this.tab_2,&
this.gb_1}
end on

on tp_gral.destroy
destroy(this.tab_4)
destroy(this.sle_1)
destroy(this.st_1)
destroy(this.tab_2)
destroy(this.gb_1)
end on

type tab_4 from tab within tp_gral
event create ( )
event destroy ( )
integer x = 69
integer y = 604
integer width = 2848
integer height = 964
integer taborder = 140
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long backcolor = 67108864
boolean raggedright = true
boolean focusonbuttondown = true
integer selectedtab = 1
tabpage_2 tabpage_2
end type

on tab_4.create
this.tabpage_2=create tabpage_2
this.Control[]={this.tabpage_2}
end on

on tab_4.destroy
destroy(this.tabpage_2)
end on

type tabpage_2 from userobject within tab_4
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 2811
integer height = 836
long backcolor = 67108864
string text = "Parametros"
long tabtextcolor = 33554432
string picturename = "AppRectangle!"
long picturemaskcolor = 536870912
dw_4 dw_4
end type

on tabpage_2.create
this.dw_4=create dw_4
this.Control[]={this.dw_4}
end on

on tabpage_2.destroy
destroy(this.dw_4)
end on

type dw_4 from datawindow within tabpage_2
integer x = 27
integer y = 16
integer width = 2761
integer height = 808
integer taborder = 100
string title = "none"
string dataobject = "dw_parametros_gen"
boolean hscrollbar = true
boolean vscrollbar = true
boolean livescroll = true
borderstyle borderstyle = stylelowered!
end type

event constructor;if isvalid(w_principal) then
	settransobject(sqlca)
	retrieve()
end if
end event

type sle_1 from singlelineedit within tp_gral
integer x = 571
integer y = 20
integer width = 2185
integer height = 76
integer taborder = 90
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean enabled = false
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 then Registryget ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DIRECTORIO", regstring!, text)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DIRECTORIO", regstring!, text)
if isnull(text) or trim(text)="" then
	text=g_ruta
end if
end event

type st_1 from statictext within tp_gral
integer x = 18
integer y = 24
integer width = 549
integer height = 72
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Directorio de Instalación:"
boolean focusrectangle = false
end type

type tab_2 from tab within tp_gral
event create ( )
event destroy ( )
event p_cambia ( )
integer x = 37
integer y = 180
integer width = 2688
integer height = 376
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long backcolor = 67108864
boolean fixedwidth = true
boolean raggedright = true
boolean focusonbuttondown = true
integer selectedtab = 1
tp_1 tp_1
tp_2 tp_2
tp_ole tp_ole
end type

on tab_2.create
this.tp_1=create tp_1
this.tp_2=create tp_2
this.tp_ole=create tp_ole
this.Control[]={this.tp_1,&
this.tp_2,&
this.tp_ole}
end on

on tab_2.destroy
destroy(this.tp_1)
destroy(this.tp_2)
destroy(this.tp_ole)
end on

event p_cambia();choose case tag
	case 'ODBC'
		tab_2.selectedtab=1
	case 'SYC Adaptive Server Enterprise'
		tab_2.selectedtab=2
	case 'OLE DB'
		tab_2.selectedtab=3
end choose

end event

event constructor;if ls_pro=32 THEN	RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS", Regstring!, tag )
if ls_pro=64 THEN	RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS", Regstring!, tag )
post event p_cambia()
end event

type tp_1 from userobject within tab_2
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 2651
integer height = 248
long backcolor = 67108864
string text = "ODBC"
long tabtextcolor = 33554432
string picturename = "odbc.ico"
long picturemaskcolor = 536870912
ddlb_1 ddlb_1
cb_2 cb_2
st_4 st_4
st_33 st_33
sle_logidod sle_logidod
st_34 st_34
sle_logpassod sle_logpassod
end type

on tp_1.create
this.ddlb_1=create ddlb_1
this.cb_2=create cb_2
this.st_4=create st_4
this.st_33=create st_33
this.sle_logidod=create sle_logidod
this.st_34=create st_34
this.sle_logpassod=create sle_logpassod
this.Control[]={this.ddlb_1,&
this.cb_2,&
this.st_4,&
this.st_33,&
this.sle_logidod,&
this.st_34,&
this.sle_logpassod}
end on

on tp_1.destroy
destroy(this.ddlb_1)
destroy(this.cb_2)
destroy(this.st_4)
destroy(this.st_33)
destroy(this.sle_logidod)
destroy(this.st_34)
destroy(this.sle_logpassod)
end on

type ddlb_1 from dropdownlistbox within tp_1
integer y = 80
integer width = 850
integer height = 400
integer taborder = 80
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "none"
boolean sorted = false
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

event constructor;string valores[],cual
long j,k
j=RegistryValues ( "HKEY_LOCAL_MACHINE\SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources", valores ) 
j=upperbound(valores)
for k=1 to j
	this.insertitem(valores[k],1)
next
this.sorted=true

if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM", Regstring!, cual)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\","DBPARM", Regstring!, cual)
j=pos(cual,"DSN=")
k=pos(cual,";",j)
cual=mid(cual,j +4 , k - j -4)
this.text=cual
end event

event modified;sle_logidod.text=''
sle_logpassod.text=''
end event

type cb_2 from commandbutton within tp_1
integer x = 869
integer y = 80
integer width = 155
integer height = 84
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "ODBC"
end type

event clicked;Run('odbcad32', normal!)
end event

type st_4 from statictext within tp_1
integer x = 23
integer y = 20
integer width = 361
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "DSN Aplicación:"
boolean focusrectangle = false
end type

type st_33 from statictext within tp_1
integer x = 1216
integer y = 20
integer width = 389
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Usuario de la BD:"
boolean focusrectangle = false
end type

type sle_logidod from singlelineedit within tp_1
integer x = 1211
integer y = 80
integer width = 489
integer height = 80
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID", Regstring!, this.text )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID", Regstring!, this.text )

end event

event modified;sle_logpassod.text=''
end event

type st_34 from statictext within tp_1
integer x = 1865
integer y = 20
integer width = 370
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Clave de la DB:"
boolean focusrectangle = false
end type

type sle_logpassod from singlelineedit within tp_1
integer x = 1865
integer y = 80
integer width = 489
integer height = 80
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean password = true
borderstyle borderstyle = stylelowered!
end type

event constructor;string l_pass
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS", Regstring!, l_pass)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS", Regstring!, l_pass )
this.text=f_descripta(l_pass)
end event

type tp_2 from userobject within tab_2
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 2651
integer height = 248
long backcolor = 67108864
string text = "Sybase"
long tabtextcolor = 33554432
string picturename = "sybase.ico"
long picturemaskcolor = 536870912
ddlb_2 ddlb_2
st_3 st_3
sle_serv sle_serv
sle_bd sle_bd
sle_logid sle_logid
sle_logpass sle_logpass
st_2 st_2
st_21 st_21
st_22 st_22
st_23 st_23
end type

on tp_2.create
this.ddlb_2=create ddlb_2
this.st_3=create st_3
this.sle_serv=create sle_serv
this.sle_bd=create sle_bd
this.sle_logid=create sle_logid
this.sle_logpass=create sle_logpass
this.st_2=create st_2
this.st_21=create st_21
this.st_22=create st_22
this.st_23=create st_23
this.Control[]={this.ddlb_2,&
this.st_3,&
this.sle_serv,&
this.sle_bd,&
this.sle_logid,&
this.sle_logpass,&
this.st_2,&
this.st_21,&
this.st_22,&
this.st_23}
end on

on tp_2.destroy
destroy(this.ddlb_2)
destroy(this.st_3)
destroy(this.sle_serv)
destroy(this.sle_bd)
destroy(this.sle_logid)
destroy(this.sle_logpass)
destroy(this.st_2)
destroy(this.st_21)
destroy(this.st_22)
destroy(this.st_23)
end on

type ddlb_2 from dropdownlistbox within tp_2
integer x = 1934
integer y = 8
integer width = 430
integer height = 228
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"11","12","12.5.1","15"}
borderstyle borderstyle = stylelowered!
end type

event constructor;string ojo,vers
long donde,donde2

if ls_pro=32 THEN	RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM2", Regstring!, ojo)
if ls_pro=64 THEN	RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM2", Regstring!, ojo)
donde=pos(ojo,'release=')
if donde=0 then return
donde2=pos(ojo,"'",donde+9)
vers=mid(ojo,donde+9,donde2 - donde - 9)
text=vers
end event

type st_3 from statictext within tp_2
integer x = 1618
integer y = 16
integer width = 306
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Versión ASE:"
boolean focusrectangle = false
end type

type sle_serv from singlelineedit within tp_2
integer x = 261
integer y = 16
integer width = 457
integer height = 80
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN	RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "SERVERNAME", Regstring!, this.text )
if ls_pro=64 THEN	RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "SERVERNAME", Regstring!, this.text )

end event

type sle_bd from singlelineedit within tp_2
integer x = 1074
integer y = 16
integer width = 457
integer height = 80
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN	RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DATABASE", Regstring!, this.text )
if ls_pro=64 THEN	RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DATABASE", Regstring!, this.text )

end event

type sle_logid from singlelineedit within tp_2
integer x = 261
integer y = 140
integer width = 457
integer height = 80
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN	RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID", Regstring!, this.text )
if ls_pro=64 THEN	 RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID", Regstring!, this.text )
	
end event

type sle_logpass from singlelineedit within tp_2
integer x = 1074
integer y = 140
integer width = 457
integer height = 80
integer taborder = 90
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean password = true
borderstyle borderstyle = stylelowered!
end type

event constructor;string l_pass
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS", Regstring!, l_pass)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS", Regstring!, l_pass )
this.text=f_descripta(l_pass)
end event

type st_2 from statictext within tp_2
integer y = 24
integer width = 343
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Servidor:"
boolean focusrectangle = false
end type

type st_21 from statictext within tp_2
integer x = 800
integer y = 24
integer width = 279
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Base Datos:"
boolean focusrectangle = false
end type

type st_22 from statictext within tp_2
integer y = 160
integer width = 279
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Usuario BD:"
boolean focusrectangle = false
end type

type st_23 from statictext within tp_2
integer x = 800
integer y = 160
integer width = 229
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Clave DB:"
boolean focusrectangle = false
end type

type tp_ole from userobject within tab_2
integer x = 18
integer y = 112
integer width = 2651
integer height = 248
long backcolor = 67108864
string text = "OLE DB"
long tabtextcolor = 33554432
string picturename = "oledb.ico"
long picturemaskcolor = 536870912
cb_10 cb_10
st_42 st_42
sle_6 sle_6
st_41 st_41
cbx_1 cbx_1
ddlb_3 ddlb_3
end type

on tp_ole.create
this.cb_10=create cb_10
this.st_42=create st_42
this.sle_6=create sle_6
this.st_41=create st_41
this.cbx_1=create cbx_1
this.ddlb_3=create ddlb_3
this.Control[]={this.cb_10,&
this.st_42,&
this.sle_6,&
this.st_41,&
this.cbx_1,&
this.ddlb_3}
end on

on tp_ole.destroy
destroy(this.cb_10)
destroy(this.st_42)
destroy(this.sle_6)
destroy(this.st_41)
destroy(this.cbx_1)
destroy(this.ddlb_3)
end on

type cb_10 from commandbutton within tp_ole
integer x = 2542
integer y = 132
integer width = 91
integer height = 84
integer taborder = 21
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "..."
end type

event clicked;string nombre
GetFileOpenName ( 'Archivo de Conexión de Datos', sle_6.text, nombre , '*.udl' , "Archivos UDL (*.udl),*.udl"  , tab_1.tp_gral.sle_1.text   )


end event

type st_42 from statictext within tp_ole
integer x = 905
integer y = 80
integer width = 480
integer height = 52
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Archivo de Conexión:"
boolean focusrectangle = false
end type

type sle_6 from singlelineedit within tp_ole
integer x = 901
integer y = 132
integer width = 1618
integer height = 88
integer taborder = 90
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_FILE", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_FILE", Regstring!, text )

end event

type st_41 from statictext within tp_ole
integer x = 14
integer y = 80
integer width = 343
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Proveedor:"
boolean focusrectangle = false
end type

type cbx_1 from checkbox within tp_ole
integer x = 18
integer width = 1047
integer height = 72
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
boolean enabled = false
string text = "Seguridad Integrada con Sistema Operativo"
boolean checked = true
end type

type ddlb_3 from dropdownlistbox within tp_ole
integer x = 9
integer y = 136
integer width = 850
integer height = 400
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string item[] = {"SQLOLEDB"}
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_PROVIDER", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_PROVIDER", Regstring!, text )
if text='' then text='SQLOLEDB'
end event

type gb_1 from groupbox within tp_gral
integer y = 120
integer width = 2770
integer height = 464
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "De la Aplicación (DBMS):"
end type

type tabpage_1 from userobject within tab_1
integer x = 18
integer y = 112
integer width = 2935
integer height = 1636
long backcolor = 67108864
string text = "Asistencial"
long tabtextcolor = 33554432
string picturename = "control.ico"
long picturemaskcolor = 536870912
tab_5 tab_5
st_24 st_24
st_20 st_20
st_10 st_10
st_9 st_9
st_39 st_39
d_ting d_ting
cbx_rf cbx_rf
cbx_pideprof cbx_pideprof
cbx_muevek cbx_muevek
cb_6 cb_6
cb_5 cb_5
dw_3 dw_3
st_8 st_8
dw_2 dw_2
dw_1 dw_1
st_7 st_7
st_6 st_6
gb_2 gb_2
dw_alm_cext dw_alm_cext
dw_alm_urg dw_alm_urg
dw_alm_hosp dw_alm_hosp
dw_alm_amb dw_alm_amb
gb_5 gb_5
end type

on tabpage_1.create
this.tab_5=create tab_5
this.st_24=create st_24
this.st_20=create st_20
this.st_10=create st_10
this.st_9=create st_9
this.st_39=create st_39
this.d_ting=create d_ting
this.cbx_rf=create cbx_rf
this.cbx_pideprof=create cbx_pideprof
this.cbx_muevek=create cbx_muevek
this.cb_6=create cb_6
this.cb_5=create cb_5
this.dw_3=create dw_3
this.st_8=create st_8
this.dw_2=create dw_2
this.dw_1=create dw_1
this.st_7=create st_7
this.st_6=create st_6
this.gb_2=create gb_2
this.dw_alm_cext=create dw_alm_cext
this.dw_alm_urg=create dw_alm_urg
this.dw_alm_hosp=create dw_alm_hosp
this.dw_alm_amb=create dw_alm_amb
this.gb_5=create gb_5
this.Control[]={this.tab_5,&
this.st_24,&
this.st_20,&
this.st_10,&
this.st_9,&
this.st_39,&
this.d_ting,&
this.cbx_rf,&
this.cbx_pideprof,&
this.cbx_muevek,&
this.cb_6,&
this.cb_5,&
this.dw_3,&
this.st_8,&
this.dw_2,&
this.dw_1,&
this.st_7,&
this.st_6,&
this.gb_2,&
this.dw_alm_cext,&
this.dw_alm_urg,&
this.dw_alm_hosp,&
this.dw_alm_amb,&
this.gb_5}
end on

on tabpage_1.destroy
destroy(this.tab_5)
destroy(this.st_24)
destroy(this.st_20)
destroy(this.st_10)
destroy(this.st_9)
destroy(this.st_39)
destroy(this.d_ting)
destroy(this.cbx_rf)
destroy(this.cbx_pideprof)
destroy(this.cbx_muevek)
destroy(this.cb_6)
destroy(this.cb_5)
destroy(this.dw_3)
destroy(this.st_8)
destroy(this.dw_2)
destroy(this.dw_1)
destroy(this.st_7)
destroy(this.st_6)
destroy(this.gb_2)
destroy(this.dw_alm_cext)
destroy(this.dw_alm_urg)
destroy(this.dw_alm_hosp)
destroy(this.dw_alm_amb)
destroy(this.gb_5)
end on

type tab_5 from tab within tabpage_1
integer x = 27
integer y = 112
integer width = 2830
integer height = 688
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long backcolor = 67108864
boolean raggedright = true
boolean focusonbuttondown = true
integer selectedtab = 1
tabpage_4 tabpage_4
tabpage_5 tabpage_5
end type

on tab_5.create
this.tabpage_4=create tabpage_4
this.tabpage_5=create tabpage_5
this.Control[]={this.tabpage_4,&
this.tabpage_5}
end on

on tab_5.destroy
destroy(this.tabpage_4)
destroy(this.tabpage_5)
end on

type tabpage_4 from userobject within tab_5
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 2793
integer height = 560
long backcolor = 67108864
string text = "Capitados"
long tabtextcolor = 33554432
string picturename = "capitado.ico"
long picturemaskcolor = 536870912
tab_3 tab_3
cbx_3 cbx_3
end type

on tabpage_4.create
this.tab_3=create tab_3
this.cbx_3=create cbx_3
this.Control[]={this.tab_3,&
this.cbx_3}
end on

on tabpage_4.destroy
destroy(this.tab_3)
destroy(this.cbx_3)
end on

type tab_3 from tab within tabpage_4
event create ( )
event destroy ( )
event p_cambia ( )
integer x = 18
integer y = 84
integer width = 2674
integer height = 452
integer taborder = 90
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long backcolor = 67108864
boolean raggedright = true
boolean focusonbuttondown = true
integer selectedtab = 1
tabpage_6 tabpage_6
tabpage_7 tabpage_7
tabpage_8 tabpage_8
end type

on tab_3.create
this.tabpage_6=create tabpage_6
this.tabpage_7=create tabpage_7
this.tabpage_8=create tabpage_8
this.Control[]={this.tabpage_6,&
this.tabpage_7,&
this.tabpage_8}
end on

on tab_3.destroy
destroy(this.tabpage_6)
destroy(this.tabpage_7)
destroy(this.tabpage_8)
end on

event p_cambia();choose case tag
	case 'ODBC'
		tab_3.selectedtab=1
	case 'SYC Adaptive Server Enterprise'
		tab_3.selectedtab=2
	case 'OLE DB'
		tab_3.selectedtab=3
end choose

end event

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_CAPI", Regstring!, tag )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_CAPI", Regstring!, tag )
post event p_cambia()


end event

type tabpage_6 from userobject within tab_3
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 2638
integer height = 324
long backcolor = 67108864
string text = "ODBC"
long tabtextcolor = 33554432
string picturename = "odbc.ico"
long picturemaskcolor = 536870912
st_38 st_38
sle_capi_pas_od sle_capi_pas_od
st_35 st_35
sle_4 sle_4
cb_1 cb_1
ddlb_5 ddlb_5
st_29 st_29
end type

on tabpage_6.create
this.st_38=create st_38
this.sle_capi_pas_od=create sle_capi_pas_od
this.st_35=create st_35
this.sle_4=create sle_4
this.cb_1=create cb_1
this.ddlb_5=create ddlb_5
this.st_29=create st_29
this.Control[]={this.st_38,&
this.sle_capi_pas_od,&
this.st_35,&
this.sle_4,&
this.cb_1,&
this.ddlb_5,&
this.st_29}
end on

on tabpage_6.destroy
destroy(this.st_38)
destroy(this.sle_capi_pas_od)
destroy(this.st_35)
destroy(this.sle_4)
destroy(this.cb_1)
destroy(this.ddlb_5)
destroy(this.st_29)
end on

type st_38 from statictext within tabpage_6
integer x = 2130
integer y = 32
integer width = 343
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Clave de la DB:"
boolean focusrectangle = false
end type

type sle_capi_pas_od from singlelineedit within tabpage_6
integer x = 2130
integer y = 112
integer width = 402
integer height = 80
integer taborder = 43
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean password = true
borderstyle borderstyle = stylelowered!
end type

event constructor;string l_pass
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_CAPI", Regstring!, l_pass)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_CAPI", Regstring!, l_pass )
this.text=f_descripta(l_pass)
end event

type st_35 from statictext within tabpage_6
integer x = 1358
integer y = 32
integer width = 389
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Usuario de la BD:"
boolean focusrectangle = false
end type

type sle_4 from singlelineedit within tabpage_6
integer x = 1358
integer y = 112
integer width = 704
integer height = 80
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_CAPI", Regstring!, text )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_CAPI", Regstring!, text )
end event

event modified;sle_capi_pas_od.text=''
end event

type cb_1 from commandbutton within tabpage_6
integer x = 946
integer y = 112
integer width = 219
integer height = 80
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "ODBC"
end type

event clicked;Run('odbcad32', normal!)
end event

type ddlb_5 from dropdownlistbox within tabpage_6
integer x = 18
integer y = 112
integer width = 850
integer height = 400
integer taborder = 100
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean allowedit = true
boolean hscrollbar = true
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

event constructor;string valores[],cual
long j,k
j=RegistryValues ( "HKEY_LOCAL_MACHINE\SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources", valores ) 
j=upperbound(valores)
for k=1 to j
	insertitem(valores[k],1)
next
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM_CAPI", Regstring!, cual)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM_CAPI", Regstring!, cual)
j=pos(cual,"DSN=")
k=pos(cual,";",j)
cual=mid(cual,j +4 , k - j -4)
text=cual
end event

type st_29 from statictext within tabpage_6
integer x = 18
integer y = 32
integer width = 361
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "DSN Aplicación:"
boolean focusrectangle = false
end type

type tabpage_7 from userobject within tab_3
integer x = 18
integer y = 112
integer width = 2638
integer height = 324
long backcolor = 67108864
string text = "Sybase"
long tabtextcolor = 33554432
string picturename = "sybase.ico"
long picturemaskcolor = 536870912
ddlb_7 ddlb_7
st_54 st_54
sle_capi_pas_syb sle_capi_pas_syb
st_53 st_53
sle_9 sle_9
st_52 st_52
sle_10 sle_10
st_44 st_44
sle_8 sle_8
st_40 st_40
end type

on tabpage_7.create
this.ddlb_7=create ddlb_7
this.st_54=create st_54
this.sle_capi_pas_syb=create sle_capi_pas_syb
this.st_53=create st_53
this.sle_9=create sle_9
this.st_52=create st_52
this.sle_10=create sle_10
this.st_44=create st_44
this.sle_8=create sle_8
this.st_40=create st_40
this.Control[]={this.ddlb_7,&
this.st_54,&
this.sle_capi_pas_syb,&
this.st_53,&
this.sle_9,&
this.st_52,&
this.sle_10,&
this.st_44,&
this.sle_8,&
this.st_40}
end on

on tabpage_7.destroy
destroy(this.ddlb_7)
destroy(this.st_54)
destroy(this.sle_capi_pas_syb)
destroy(this.st_53)
destroy(this.sle_9)
destroy(this.st_52)
destroy(this.sle_10)
destroy(this.st_44)
destroy(this.sle_8)
destroy(this.st_40)
end on

type ddlb_7 from dropdownlistbox within tabpage_7
integer x = 1938
integer y = 12
integer width = 430
integer height = 204
integer taborder = 100
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"11","12","12.5.1","15"}
borderstyle borderstyle = stylelowered!
end type

event constructor;string ojo,vers
long donde,donde2
if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM2_CAPI", Regstring!, ojo)
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM2_CAPI", Regstring!, ojo)
donde=pos(ojo,'release=')
if donde=0 then return
donde2=pos(ojo,"'",donde+9)
vers=mid(ojo,donde+9,donde2 - donde - 9)
text=vers
end event

type st_54 from statictext within tabpage_7
integer x = 1623
integer y = 20
integer width = 306
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Versión ASE:"
boolean focusrectangle = false
end type

type sle_capi_pas_syb from singlelineedit within tabpage_7
integer x = 1070
integer y = 124
integer width = 489
integer height = 80
integer taborder = 100
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean password = true
borderstyle borderstyle = stylelowered!
end type

event constructor;string l_pass
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_CAPI", Regstring!, l_pass)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_CAPI", Regstring!, l_pass )
this.text=f_descripta(l_pass)
end event

type st_53 from statictext within tabpage_7
integer x = 841
integer y = 140
integer width = 224
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Clave DB:"
boolean focusrectangle = false
end type

type sle_9 from singlelineedit within tabpage_7
integer x = 1070
integer y = 16
integer width = 489
integer height = 80
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DATABASE_CAPI", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DATABASE_CAPI", Regstring!, text )
end event

type st_52 from statictext within tabpage_7
integer x = 791
integer y = 24
integer width = 274
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Base Datos:"
boolean focusrectangle = false
end type

type sle_10 from singlelineedit within tabpage_7
integer x = 265
integer y = 124
integer width = 489
integer height = 80
integer taborder = 90
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_CAPI", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_CAPI", Regstring!, text )
end event

type st_44 from statictext within tabpage_7
integer y = 140
integer width = 261
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Usuario BD:"
boolean focusrectangle = false
end type

type sle_8 from singlelineedit within tabpage_7
integer x = 265
integer y = 16
integer width = 489
integer height = 80
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "SERVERNAME_CAPI", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "SERVERNAME_CAPI", Regstring!, text )
end event

type st_40 from statictext within tabpage_7
integer y = 24
integer width = 215
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Servidor:"
boolean focusrectangle = false
end type

type tabpage_8 from userobject within tab_3
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 2638
integer height = 324
long backcolor = 67108864
string text = "OLE DB"
long tabtextcolor = 33554432
string picturename = "oledb.ico"
long picturemaskcolor = 536870912
cb_4 cb_4
sle_con sle_con
st_27 st_27
ddlb_6 ddlb_6
st_26 st_26
cbx_4 cbx_4
end type

on tabpage_8.create
this.cb_4=create cb_4
this.sle_con=create sle_con
this.st_27=create st_27
this.ddlb_6=create ddlb_6
this.st_26=create st_26
this.cbx_4=create cbx_4
this.Control[]={this.cb_4,&
this.sle_con,&
this.st_27,&
this.ddlb_6,&
this.st_26,&
this.cbx_4}
end on

on tabpage_8.destroy
destroy(this.cb_4)
destroy(this.sle_con)
destroy(this.st_27)
destroy(this.ddlb_6)
destroy(this.st_26)
destroy(this.cbx_4)
end on

type cb_4 from commandbutton within tabpage_8
integer x = 2519
integer y = 132
integer width = 91
integer height = 84
integer taborder = 31
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "..."
end type

event clicked;string nombre
GetFileOpenName ( 'Archivo de Conexión de Datos', sle_con.text, nombre , '*.udl' , "Archivos UDL (*.udl),*.udl"  , tab_1.tp_gral.sle_1.text)


end event

type sle_con from singlelineedit within tabpage_8
integer x = 891
integer y = 132
integer width = 1618
integer height = 84
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_FILE_CAPI", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_FILE_CAPI", Regstring!, text )

end event

type st_27 from statictext within tabpage_8
integer x = 896
integer y = 72
integer width = 480
integer height = 52
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Archivo de Conexión:"
boolean focusrectangle = false
end type

type ddlb_6 from dropdownlistbox within tabpage_8
integer x = 9
integer y = 136
integer width = 850
integer height = 188
integer taborder = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean allowedit = true
boolean hscrollbar = true
boolean vscrollbar = true
string item[] = {"SQLOLEDB"}
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN	 RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_PROVIDER_CAPI", Regstring!, text )
if ls_pro=64 THEN	 RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_PROVIDER_CAPI", Regstring!, text )
if text='' then text='SQLOLEDB'
end event

type st_26 from statictext within tabpage_8
integer x = 14
integer y = 76
integer width = 343
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Proveedor:"
boolean focusrectangle = false
end type

type cbx_4 from checkbox within tabpage_8
integer x = 18
integer y = 8
integer width = 1047
integer height = 72
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
boolean enabled = false
string text = "Seguridad Integrada con Sistema Operativo"
boolean checked = true
end type

type cbx_3 from checkbox within tabpage_4
integer x = 27
integer y = 8
integer width = 608
integer height = 72
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Base de datos Capitada:"
end type

event constructor;string ojo
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "BASE_CAPI", Regstring!, ojo)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "BASE_CAPI", Regstring!, ojo)
if ojo='1' then
	checked=true
	tab_1.tabpage_1.tab_5.tabpage_4.tab_3.visible=true
else
	checked=false
	tab_1.tabpage_1.tab_5.tabpage_4.tab_3.visible=false
end if
end event

event clicked;tab_1.tabpage_1.tab_5.tabpage_4.tab_3.visible=checked
end event

type tabpage_5 from userobject within tab_5
integer x = 18
integer y = 112
integer width = 2793
integer height = 560
long backcolor = 67108864
string text = "Equipos"
long tabtextcolor = 33554432
string picturename = "equipo.ico"
long picturemaskcolor = 536870912
cbx_5 cbx_5
tab_6 tab_6
end type

on tabpage_5.create
this.cbx_5=create cbx_5
this.tab_6=create tab_6
this.Control[]={this.cbx_5,&
this.tab_6}
end on

on tabpage_5.destroy
destroy(this.cbx_5)
destroy(this.tab_6)
end on

type cbx_5 from checkbox within tabpage_5
integer x = 27
integer y = 8
integer width = 608
integer height = 72
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Base de datos Equipos:"
end type

event clicked;tab_1.tabpage_1.tab_5.tabpage_5.tab_6.visible=checked
end event

event constructor;string ojo
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "BASE_EQU", Regstring!, ojo)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "BASE_EQU", Regstring!, ojo)
if ojo='1' then
	checked=true
	tab_1.tabpage_1.tab_5.tabpage_5.tab_6.visible=true
else
	checked=false
	tab_1.tabpage_1.tab_5.tabpage_5.tab_6.visible=false
end if


end event

type tab_6 from tab within tabpage_5
event create ( )
event destroy ( )
event p_cambia ( )
integer x = 18
integer y = 80
integer width = 2679
integer height = 468
integer taborder = 100
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long backcolor = 67108864
boolean raggedright = true
boolean focusonbuttondown = true
integer selectedtab = 1
tabpage_9 tabpage_9
tabpage_10 tabpage_10
tabpage_11 tabpage_11
end type

on tab_6.create
this.tabpage_9=create tabpage_9
this.tabpage_10=create tabpage_10
this.tabpage_11=create tabpage_11
this.Control[]={this.tabpage_9,&
this.tabpage_10,&
this.tabpage_11}
end on

on tab_6.destroy
destroy(this.tabpage_9)
destroy(this.tabpage_10)
destroy(this.tabpage_11)
end on

event p_cambia();choose case tag
	case 'ODBC'
		tab_6.selectedtab=1
	case 'SYC Adaptive Server Enterprise'
		tab_6.selectedtab=2
	case 'OLE DB'
		tab_6.selectedtab=3
end choose

end event

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_EQU", Regstring!, tag )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_EQU", Regstring!, tag )
post event p_cambia()



end event

type tabpage_9 from userobject within tab_6
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 2642
integer height = 340
long backcolor = 67108864
string text = "ODBC"
long tabtextcolor = 33554432
string picturename = "odbc.ico"
long picturemaskcolor = 536870912
st_45 st_45
ddlb_8 ddlb_8
cb_3 cb_3
sle_11 sle_11
st_43 st_43
sle_12 sle_12
st_28 st_28
end type

on tabpage_9.create
this.st_45=create st_45
this.ddlb_8=create ddlb_8
this.cb_3=create cb_3
this.sle_11=create sle_11
this.st_43=create st_43
this.sle_12=create sle_12
this.st_28=create st_28
this.Control[]={this.st_45,&
this.ddlb_8,&
this.cb_3,&
this.sle_11,&
this.st_43,&
this.sle_12,&
this.st_28}
end on

on tabpage_9.destroy
destroy(this.st_45)
destroy(this.ddlb_8)
destroy(this.cb_3)
destroy(this.sle_11)
destroy(this.st_43)
destroy(this.sle_12)
destroy(this.st_28)
end on

type st_45 from statictext within tabpage_9
integer x = 18
integer y = 8
integer width = 361
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "DSN Aplicación:"
boolean focusrectangle = false
end type

type ddlb_8 from dropdownlistbox within tabpage_9
integer x = 18
integer y = 76
integer width = 850
integer height = 400
integer taborder = 90
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;string valores[],cual
long j,k
j=RegistryValues ( "HKEY_LOCAL_MACHINE\SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources", valores ) 
j=upperbound(valores)
for k=1 to j
	insertitem(valores[k],1)
next
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM_EQU", Regstring!, cual)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM_EQU", Regstring!, cual)
j=pos(cual,"DSN=")
k=pos(cual,";",j)
cual=mid(cual,j +4 , k - j -4)
text=cual
end event

type cb_3 from commandbutton within tabpage_9
integer x = 882
integer y = 76
integer width = 219
integer height = 80
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "ODBC"
end type

event clicked;Run('odbcad32', normal!)
end event

type sle_11 from singlelineedit within tabpage_9
integer x = 1152
integer y = 76
integer width = 704
integer height = 80
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_EQU", Regstring!, text )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_EQU", Regstring!, text )

end event

type st_43 from statictext within tabpage_9
integer x = 1152
integer y = 8
integer width = 389
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Usuario de la BD:"
boolean focusrectangle = false
end type

type sle_12 from singlelineedit within tabpage_9
integer x = 1925
integer y = 76
integer width = 402
integer height = 80
integer taborder = 80
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean password = true
borderstyle borderstyle = stylelowered!
end type

event constructor;string l_pass
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_EQU", Regstring!, l_pass)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_EQU", Regstring!, l_pass )
this.text=f_descripta(l_pass)
end event

type st_28 from statictext within tabpage_9
integer x = 1925
integer y = 8
integer width = 343
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Clave de la DB:"
boolean focusrectangle = false
end type

type tabpage_10 from userobject within tab_6
integer x = 18
integer y = 112
integer width = 2642
integer height = 340
long backcolor = 67108864
string text = "Sybase"
long tabtextcolor = 33554432
string picturename = "sybase.ico"
long picturemaskcolor = 536870912
st_50 st_50
sle_13 sle_13
st_49 st_49
sle_15 sle_15
st_48 st_48
sle_14 sle_14
st_47 st_47
sle_16 sle_16
st_46 st_46
ddlb_9 ddlb_9
end type

on tabpage_10.create
this.st_50=create st_50
this.sle_13=create sle_13
this.st_49=create st_49
this.sle_15=create sle_15
this.st_48=create st_48
this.sle_14=create sle_14
this.st_47=create st_47
this.sle_16=create sle_16
this.st_46=create st_46
this.ddlb_9=create ddlb_9
this.Control[]={this.st_50,&
this.sle_13,&
this.st_49,&
this.sle_15,&
this.st_48,&
this.sle_14,&
this.st_47,&
this.sle_16,&
this.st_46,&
this.ddlb_9}
end on

on tabpage_10.destroy
destroy(this.st_50)
destroy(this.sle_13)
destroy(this.st_49)
destroy(this.sle_15)
destroy(this.st_48)
destroy(this.sle_14)
destroy(this.st_47)
destroy(this.sle_16)
destroy(this.st_46)
destroy(this.ddlb_9)
end on

type st_50 from statictext within tabpage_10
integer y = 24
integer width = 215
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Servidor:"
boolean focusrectangle = false
end type

type sle_13 from singlelineedit within tabpage_10
integer x = 265
integer y = 16
integer width = 489
integer height = 80
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "SERVERNAME_EQU", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "SERVERNAME_EQU", Regstring!, text )


end event

type st_49 from statictext within tabpage_10
integer y = 140
integer width = 261
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Usuario BD:"
boolean focusrectangle = false
end type

type sle_15 from singlelineedit within tabpage_10
integer x = 265
integer y = 124
integer width = 489
integer height = 80
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_EQU", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_EQU", Regstring!, text )
end event

type st_48 from statictext within tabpage_10
integer x = 791
integer y = 24
integer width = 274
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Base Datos:"
boolean focusrectangle = false
end type

type sle_14 from singlelineedit within tabpage_10
integer x = 1070
integer y = 16
integer width = 489
integer height = 80
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DATABASE_EQU", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DATABASE_EQU", Regstring!, text )
end event

type st_47 from statictext within tabpage_10
integer x = 841
integer y = 140
integer width = 224
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Clave DB:"
boolean focusrectangle = false
end type

type sle_16 from singlelineedit within tabpage_10
integer x = 1070
integer y = 124
integer width = 489
integer height = 80
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean password = true
borderstyle borderstyle = stylelowered!
end type

event constructor;string l_pass
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_EQU", Regstring!, l_pass)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_EQU", Regstring!, l_pass )
this.text=f_descripta(l_pass)
end event

type st_46 from statictext within tabpage_10
integer x = 1623
integer y = 20
integer width = 306
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Versión ASE:"
boolean focusrectangle = false
end type

type ddlb_9 from dropdownlistbox within tabpage_10
integer x = 1938
integer y = 12
integer width = 416
integer height = 300
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"11","12","12.5.1","15"}
borderstyle borderstyle = stylelowered!
end type

event constructor;string ojo,vers
long donde,donde2
if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM2_EQU", Regstring!, ojo)
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM2_EQU", Regstring!, ojo)
donde=pos(ojo,'release=')
if donde=0 then return
donde2=pos(ojo,"'",donde+9)
vers=mid(ojo,donde+9,donde2 - donde - 9)
text=vers
end event

type tabpage_11 from userobject within tab_6
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 2642
integer height = 340
long backcolor = 67108864
string text = "OLE DB"
long tabtextcolor = 33554432
string picturename = "oledb.ico"
long picturemaskcolor = 536870912
cb_8 cb_8
cbx_2 cbx_2
st_55 st_55
ddlb_10 ddlb_10
st_51 st_51
sle_17 sle_17
end type

on tabpage_11.create
this.cb_8=create cb_8
this.cbx_2=create cbx_2
this.st_55=create st_55
this.ddlb_10=create ddlb_10
this.st_51=create st_51
this.sle_17=create sle_17
this.Control[]={this.cb_8,&
this.cbx_2,&
this.st_55,&
this.ddlb_10,&
this.st_51,&
this.sle_17}
end on

on tabpage_11.destroy
destroy(this.cb_8)
destroy(this.cbx_2)
destroy(this.st_55)
destroy(this.ddlb_10)
destroy(this.st_51)
destroy(this.sle_17)
end on

type cb_8 from commandbutton within tabpage_11
integer x = 2519
integer y = 132
integer width = 91
integer height = 84
integer taborder = 31
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "..."
end type

event clicked;string nombre
GetFileOpenName ( 'Archivo de Conexión de Datos', sle_17.text, nombre , '*.udl' , "Archivos UDL (*.udl),*.udl"  , tab_1.tp_gral.sle_1.text)


end event

type cbx_2 from checkbox within tabpage_11
integer x = 18
integer y = 8
integer width = 1047
integer height = 72
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
boolean enabled = false
string text = "Seguridad Integrada con Sistema Operativo"
boolean checked = true
end type

type st_55 from statictext within tabpage_11
integer x = 14
integer y = 76
integer width = 343
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Proveedor:"
boolean focusrectangle = false
end type

type ddlb_10 from dropdownlistbox within tabpage_11
integer x = 9
integer y = 136
integer width = 850
integer height = 400
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string item[] = {"SQLOLEDB"}
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN	 RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_PROVIDER_EQU", Regstring!, text )
if ls_pro=64 THEN	 RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_PROVIDER_EQU", Regstring!, text )
if text='' then text='SQLOLEDB'
end event

type st_51 from statictext within tabpage_11
integer x = 896
integer y = 76
integer width = 480
integer height = 52
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Archivo de Conexión:"
boolean focusrectangle = false
end type

type sle_17 from singlelineedit within tabpage_11
integer x = 891
integer y = 136
integer width = 1618
integer height = 84
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_FILE_EQU", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_FILE_EQU", Regstring!, text )

end event

type st_24 from statictext within tabpage_1
integer x = 1248
integer y = 1288
integer width = 343
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Ambulatorio"
boolean focusrectangle = false
end type

type st_20 from statictext within tabpage_1
integer x = 59
integer y = 1288
integer width = 343
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Hospitalización"
boolean focusrectangle = false
end type

type st_10 from statictext within tabpage_1
integer x = 59
integer y = 1420
integer width = 471
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Consulta Externa"
boolean focusrectangle = false
end type

type st_9 from statictext within tabpage_1
integer x = 1248
integer y = 1424
integer width = 384
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Urgencias"
boolean focusrectangle = false
end type

type st_39 from statictext within tabpage_1
integer x = 1993
integer y = 24
integer width = 210
integer height = 68
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Tingreso"
boolean focusrectangle = false
end type

type d_ting from dropdownlistbox within tabpage_1
integer x = 2213
integer y = 12
integer width = 645
integer height = 400
integer taborder = 20
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 16777215
boolean sorted = false
boolean vscrollbar = true
string item[] = {"URGENCIAS","HOSPITALIZACIÓN","AMBULATORIO","UCI"}
borderstyle borderstyle = stylelowered!
end type

event constructor;string ojo
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "TINGRESO", Regstring!, ojo)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "TINGRESO", Regstring!, ojo)
choose case ojo
	case '2'
		text='Urgencias'
	case '3'
		text='Hospitalización'
	case '4'
		text='Ambulatorio'
	case '7'
		text='Uci'
end choose

end event

type cbx_rf from checkbox within tabpage_1
integer x = 73
integer y = 1032
integer width = 608
integer height = 72
integer taborder = 112
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Cargar RIPS al Facturar"
end type

event constructor;string ojo
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "RIPS_AL_FACTURAR", Regstring!, ojo)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "RIPS_AL_FACTURAR", Regstring!, ojo)
if ojo="1" then
	checked=true
else
	checked=false
end if
end event

type cbx_pideprof from checkbox within tabpage_1
boolean visible = false
integer x = 1490
integer y = 1040
integer width = 727
integer height = 68
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
boolean enabled = false
string text = "Exigir Profesional al Facturar"
end type

event constructor;string ojo

if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "PIDEPROF", Regstring!, ojo)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "PIDEPROF", Regstring!, ojo)
if ojo="1" then
	this.checked=true
else
	this.checked=false
end if
end event

type cbx_muevek from checkbox within tabpage_1
integer x = 64
integer y = 1212
integer width = 727
integer height = 72
integer taborder = 100
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Mover Kardex al Facturar"
boolean checked = true
end type

event clicked;//tab_1.tabpage_2.enabled=this.checked

end event

event constructor;string ojo
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "MUEVE_KARDEX", Regstring!, ojo)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "MUEVE_KARDEX", Regstring!, ojo)
if ojo="1" then
	this.checked=true
else
	this.checked=false
end if

end event

type cb_6 from commandbutton within tabpage_1
integer x = 2222
integer y = 936
integer width = 169
integer height = 80
integer taborder = 70
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Borrar"
end type

event clicked;dw_2.setitem(1,1,"")
end event

type cb_5 from commandbutton within tabpage_1
integer x = 2222
integer y = 852
integer width = 169
integer height = 80
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Borrar"
end type

type dw_3 from datawindow within tabpage_1
integer x = 626
integer y = 12
integer width = 1271
integer height = 84
integer taborder = 10
string dataobject = "dw_combo_lugar"
boolean hscrollbar = true
boolean vscrollbar = true
boolean border = false
end type

event constructor;settransobject(sqlca)
insertrow(1)
string ojo
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LUGAR", Regstring!, ojo)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LUGAR", Regstring!, ojo)
this.setitem(1,1,ojo)

end event

event itemchanged;idw_almcext.setfilter("codlugar ='"+data+"'")
idw_almcext.filter()
idw_almcurg.setfilter("codlugar ='"+data+"'")
idw_almcurg.filter()
idw_almhosp.setfilter("codlugar ='"+data+"'")
idw_almhosp.filter()
idw_almcamb.setfilter("codlugar ='"+data+"'")
idw_almcamb.filter()
end event

type st_8 from statictext within tabpage_1
integer x = 23
integer y = 20
integer width = 654
integer height = 60
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Lugar / Centro de Atención:"
boolean focusrectangle = false
end type

type dw_2 from datawindow within tabpage_1
integer x = 699
integer y = 936
integer width = 1376
integer height = 84
integer taborder = 60
string title = "none"
string dataobject = "dw_profe_combo_corto"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event constructor;this.settransobject(sqlca)
this.insertrow(1)
string ojo

if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "PROFE", Regstring!, ojo)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "PROFE", Regstring!, ojo)
this.setitem(1,1,ojo)
end event

type dw_1 from datawindow within tabpage_1
integer x = 727
integer y = 848
integer width = 1335
integer height = 88
integer taborder = 40
string title = "none"
string dataobject = "dw_area_peq"
boolean vscrollbar = true
boolean border = false
boolean livescroll = true
end type

event constructor;this.settransobject(sqlca)
this.insertrow(1)
string ojo

if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "AREAAPDX", Regstring!, ojo)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "AREAAPDX", Regstring!, ojo)
this.setitem(1,1,ojo)
end event

type st_7 from statictext within tabpage_1
integer x = 64
integer y = 876
integer width = 622
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Area de ApDx por defecto:"
boolean focusrectangle = false
end type

type st_6 from statictext within tabpage_1
integer x = 64
integer y = 948
integer width = 539
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Profesional por defecto:"
boolean focusrectangle = false
end type

type gb_2 from groupbox within tabpage_1
integer x = 32
integer y = 1140
integer width = 2816
integer height = 448
integer taborder = 340
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Almacenes al facturar"
end type

type dw_alm_cext from datawindow within tabpage_1
integer x = 59
integer y = 1484
integer width = 1134
integer height = 84
integer taborder = 420
boolean bringtotop = true
string title = "none"
string dataobject = "dw_combo_almacen"
boolean border = false
boolean livescroll = true
end type

event constructor;this.settransobject(sqlca)
this.getchild('codalmacen',idw_almcext)
idw_almcext.settransobject(SQLCA)
this.insertrow(1)
string alm

if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\SUMINISTROS\", "ALM_CEXT", Regstring!, alm )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\SUMINISTROS\", "ALM_CEXT", Regstring!, alm )
this.setitem(1,1,alm)
alm=dw_3.getitemstring(1,'codlugar')
idw_almcext.setfilter("codlugar ='"+alm+"'")
idw_almcext.filter()

end event

type dw_alm_urg from datawindow within tabpage_1
integer x = 1248
integer y = 1484
integer width = 1134
integer height = 96
integer taborder = 430
boolean bringtotop = true
string title = "none"
string dataobject = "dw_combo_almacen"
boolean border = false
boolean livescroll = true
borderstyle borderstyle = stylelowered!
end type

event constructor;this.settransobject(sqlca)
this.getchild('codalmacen',idw_almcurg)
idw_almcext.settransobject(SQLCA)
this.insertrow(1)
string alm

if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\SUMINISTROS\", "ALM_URG", Regstring!, alm )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\SUMINISTROS\", "ALM_URG", Regstring!, alm )
this.setitem(1,1,alm)
alm=dw_3.getitemstring(1,'codlugar')
idw_almcurg.setfilter("codlugar ='"+alm+"'")
idw_almcurg.filter()

end event

type dw_alm_hosp from datawindow within tabpage_1
integer x = 59
integer y = 1344
integer width = 1134
integer height = 80
integer taborder = 420
boolean bringtotop = true
string title = "none"
string dataobject = "dw_combo_almacen"
boolean border = false
boolean livescroll = true
end type

event constructor;this.settransobject(sqlca)
this.getchild('codalmacen',idw_almhosp)
idw_almhosp.settransobject(SQLCA)
this.insertrow(1)
string alm
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\SUMINISTROS\", "ALM_HOSP", Regstring!, alm )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\SUMINISTROS\", "ALM_HOSP", Regstring!, alm )
this.setitem(1,1,alm)
alm=dw_3.getitemstring(1,'codlugar')
idw_almhosp.setfilter("codlugar ='"+alm+"'")
idw_almhosp.filter()

end event

type dw_alm_amb from datawindow within tabpage_1
integer x = 1248
integer y = 1344
integer width = 1134
integer height = 80
integer taborder = 430
boolean bringtotop = true
string title = "none"
string dataobject = "dw_combo_almacen"
boolean border = false
boolean livescroll = true
end type

event constructor;this.settransobject(sqlca)
this.getchild('codalmacen',idw_almcamb)
idw_almcamb.settransobject(SQLCA)
this.insertrow(1)
string alm
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\SUMINISTROS\", "ALM_AMB", Regstring!, alm )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\SUMINISTROS\", "ALM_AMB", Regstring!, alm )
this.setitem(1,1,alm)
alm=dw_3.getitemstring(1,'codlugar')
idw_almcamb.setfilter("codlugar ='"+alm+"'")
idw_almcamb.filter()

end event

type gb_5 from groupbox within tabpage_1
integer x = 32
integer y = 800
integer width = 2811
integer height = 332
integer taborder = 60
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Por Defecto"
end type

type tab_mipres from userobject within tab_1
event create ( )
event destroy ( )
boolean visible = false
integer x = 18
integer y = 112
integer width = 2935
integer height = 1636
boolean enabled = false
long backcolor = 67108864
string text = "Mipres"
long tabtextcolor = 33554432
string picturename = "mipres.ico"
long picturemaskcolor = 536870912
sle_mptoken sle_mptoken
st_token st_token
tab_7 tab_7
cbx_mipres cbx_mipres
end type

on tab_mipres.create
this.sle_mptoken=create sle_mptoken
this.st_token=create st_token
this.tab_7=create tab_7
this.cbx_mipres=create cbx_mipres
this.Control[]={this.sle_mptoken,&
this.st_token,&
this.tab_7,&
this.cbx_mipres}
end on

on tab_mipres.destroy
destroy(this.sle_mptoken)
destroy(this.st_token)
destroy(this.tab_7)
destroy(this.cbx_mipres)
end on

type sle_mptoken from singlelineedit within tab_mipres
integer x = 229
integer y = 132
integer width = 1243
integer height = 84
integer taborder = 100
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "6AE99F44-666A-4329-BFA2-39617D77D91B"
boolean password = true
textcase textcase = upper!
borderstyle borderstyle = stylelowered!
end type

event constructor;string l_pass
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "TOKEN_MIPRES", Regstring!, l_pass)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "TOKEN_MIPRES", Regstring!, l_pass )
this.text=f_descripta(l_pass)
end event

type st_token from statictext within tab_mipres
integer x = 37
integer y = 148
integer width = 151
integer height = 56
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Token"
boolean focusrectangle = false
end type

type tab_7 from tab within tab_mipres
event create ( )
event destroy ( )
event p_cambia ( )
integer x = 18
integer y = 232
integer width = 2674
integer height = 452
integer taborder = 100
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long backcolor = 67108864
boolean raggedright = true
boolean focusonbuttondown = true
integer selectedtab = 1
tabodbc tabodbc
tabpage_syb tabpage_syb
tabole tabole
end type

on tab_7.create
this.tabodbc=create tabodbc
this.tabpage_syb=create tabpage_syb
this.tabole=create tabole
this.Control[]={this.tabodbc,&
this.tabpage_syb,&
this.tabole}
end on

on tab_7.destroy
destroy(this.tabodbc)
destroy(this.tabpage_syb)
destroy(this.tabole)
end on

event p_cambia();choose case tag
	case 'ODBC'
		tab_7.selectedtab=1
	case 'SYC Adaptive Server Enterprise'
		tab_7.selectedtab=2
	case 'OLE DB'
		tab_7.selectedtab=3
end choose

end event

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBMS_MIPRES", Regstring!, tag )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBMS_MIPRES", Regstring!, tag )
post event p_cambia()
end event

type tabodbc from userobject within tab_7
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 2638
integer height = 324
long backcolor = 67108864
string text = "ODBC"
long tabtextcolor = 33554432
string picturename = "odbc.ico"
long picturemaskcolor = 536870912
st_17 st_17
ddlb_modbc ddlb_modbc
cb_9 cb_9
sle_musodbc sle_musodbc
st_16 st_16
sle_mpsodbc sle_mpsodbc
st_5 st_5
end type

on tabodbc.create
this.st_17=create st_17
this.ddlb_modbc=create ddlb_modbc
this.cb_9=create cb_9
this.sle_musodbc=create sle_musodbc
this.st_16=create st_16
this.sle_mpsodbc=create sle_mpsodbc
this.st_5=create st_5
this.Control[]={this.st_17,&
this.ddlb_modbc,&
this.cb_9,&
this.sle_musodbc,&
this.st_16,&
this.sle_mpsodbc,&
this.st_5}
end on

on tabodbc.destroy
destroy(this.st_17)
destroy(this.ddlb_modbc)
destroy(this.cb_9)
destroy(this.sle_musodbc)
destroy(this.st_16)
destroy(this.sle_mpsodbc)
destroy(this.st_5)
end on

type st_17 from statictext within tabodbc
integer x = 18
integer y = 32
integer width = 361
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "DSN Aplicación:"
boolean focusrectangle = false
end type

type ddlb_modbc from dropdownlistbox within tabodbc
integer x = 18
integer y = 112
integer width = 850
integer height = 400
integer taborder = 53
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;string valores[],cual
long j,k
j=RegistryValues ( "HKEY_LOCAL_MACHINE\SOFTWARE\ODBC\ODBC.INI\ODBC Data Sources", valores ) 
j=upperbound(valores)
for k=1 to j
	insertitem(valores[k],1)
next
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM_MIPRES", Regstring!, cual)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM_MIPRES", Regstring!, cual)
j=pos(cual,"DSN=")
k=pos(cual,";",j)
cual=mid(cual,j +4 , k - j -4)
text=cual
end event

type cb_9 from commandbutton within tabodbc
integer x = 946
integer y = 112
integer width = 219
integer height = 80
integer taborder = 53
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "ODBC"
end type

event clicked;Run('odbcad32', normal!)
end event

type sle_musodbc from singlelineedit within tabodbc
integer x = 1358
integer y = 112
integer width = 704
integer height = 80
integer taborder = 53
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_MIPRES", Regstring!, text )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_MIPRES", Regstring!, text )
end event

type st_16 from statictext within tabodbc
integer x = 1358
integer y = 32
integer width = 389
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Usuario de la BD:"
boolean focusrectangle = false
end type

type sle_mpsodbc from singlelineedit within tabodbc
integer x = 2130
integer y = 112
integer width = 402
integer height = 80
integer taborder = 53
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean password = true
borderstyle borderstyle = stylelowered!
end type

event constructor;string l_pass
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_MIPRES", Regstring!, l_pass)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_MIPRES", Regstring!, l_pass )
this.text=f_descripta(l_pass)
end event

type st_5 from statictext within tabodbc
integer x = 2130
integer y = 32
integer width = 343
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Clave de la DB:"
boolean focusrectangle = false
end type

type tabpage_syb from userobject within tab_7
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 2638
integer height = 324
long backcolor = 67108864
string text = "Sybase"
long tabtextcolor = 33554432
string picturename = "sybase.ico"
long picturemaskcolor = 536870912
st_31 st_31
sle_misersyb sle_misersyb
st_30 st_30
sle_miususyb sle_miususyb
st_25 st_25
sle_mibdsyb sle_mibdsyb
st_19 st_19
sle_mipssyb sle_mipssyb
st_18 st_18
ddlb_misyb ddlb_misyb
end type

on tabpage_syb.create
this.st_31=create st_31
this.sle_misersyb=create sle_misersyb
this.st_30=create st_30
this.sle_miususyb=create sle_miususyb
this.st_25=create st_25
this.sle_mibdsyb=create sle_mibdsyb
this.st_19=create st_19
this.sle_mipssyb=create sle_mipssyb
this.st_18=create st_18
this.ddlb_misyb=create ddlb_misyb
this.Control[]={this.st_31,&
this.sle_misersyb,&
this.st_30,&
this.sle_miususyb,&
this.st_25,&
this.sle_mibdsyb,&
this.st_19,&
this.sle_mipssyb,&
this.st_18,&
this.ddlb_misyb}
end on

on tabpage_syb.destroy
destroy(this.st_31)
destroy(this.sle_misersyb)
destroy(this.st_30)
destroy(this.sle_miususyb)
destroy(this.st_25)
destroy(this.sle_mibdsyb)
destroy(this.st_19)
destroy(this.sle_mipssyb)
destroy(this.st_18)
destroy(this.ddlb_misyb)
end on

type st_31 from statictext within tabpage_syb
integer y = 24
integer width = 215
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Servidor:"
boolean focusrectangle = false
end type

type sle_misersyb from singlelineedit within tabpage_syb
integer x = 265
integer y = 16
integer width = 489
integer height = 80
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "SERVERNAME_MIPRES", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "SERVERNAME_MIPRES", Regstring!, text )
end event

type st_30 from statictext within tabpage_syb
integer y = 140
integer width = 261
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Usuario BD:"
boolean focusrectangle = false
end type

type sle_miususyb from singlelineedit within tabpage_syb
integer x = 265
integer y = 124
integer width = 489
integer height = 80
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGID_MIPRES", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGID_MIPRES", Regstring!, text )
end event

type st_25 from statictext within tabpage_syb
integer x = 791
integer y = 24
integer width = 274
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Base Datos:"
boolean focusrectangle = false
end type

type sle_mibdsyb from singlelineedit within tabpage_syb
integer x = 1070
integer y = 16
integer width = 489
integer height = 80
integer taborder = 40
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DATABASE_MIPRES", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DATABASE_MIPRES", Regstring!, text )
end event

type st_19 from statictext within tabpage_syb
integer x = 841
integer y = 140
integer width = 224
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Clave DB:"
boolean focusrectangle = false
end type

type sle_mipssyb from singlelineedit within tabpage_syb
integer x = 1070
integer y = 124
integer width = 489
integer height = 80
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean password = true
borderstyle borderstyle = stylelowered!
end type

event constructor;string l_pass
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LOGPASS_MIPRES", Regstring!, l_pass)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LOGPASS_MIPRES", Regstring!, l_pass )
this.text=f_descripta(l_pass)
end event

type st_18 from statictext within tabpage_syb
integer x = 1623
integer y = 20
integer width = 306
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Versión ASE:"
boolean focusrectangle = false
end type

type ddlb_misyb from dropdownlistbox within tabpage_syb
integer x = 1938
integer y = 12
integer width = 430
integer height = 204
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"11","12","12.5.1","15"}
borderstyle borderstyle = stylelowered!
end type

event constructor;string ojo,vers
long donde,donde2
if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "DBPARM2_MIPRES", Regstring!, ojo)
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "DBPARM2_MIPRES", Regstring!, ojo)
donde=pos(ojo,'release=')
if donde=0 then return
donde2=pos(ojo,"'",donde+9)
vers=mid(ojo,donde+9,donde2 - donde - 9)
text=vers
end event

type tabole from userobject within tab_7
event create ( )
event destroy ( )
integer x = 18
integer y = 112
integer width = 2638
integer height = 324
long backcolor = 67108864
string text = "OLE DB"
long tabtextcolor = 33554432
string picturename = "oledb.ico"
long picturemaskcolor = 536870912
cbx_7 cbx_7
st_56 st_56
ddlb_mole ddlb_mole
st_32 st_32
sle_olemps sle_olemps
cb_11 cb_11
end type

on tabole.create
this.cbx_7=create cbx_7
this.st_56=create st_56
this.ddlb_mole=create ddlb_mole
this.st_32=create st_32
this.sle_olemps=create sle_olemps
this.cb_11=create cb_11
this.Control[]={this.cbx_7,&
this.st_56,&
this.ddlb_mole,&
this.st_32,&
this.sle_olemps,&
this.cb_11}
end on

on tabole.destroy
destroy(this.cbx_7)
destroy(this.st_56)
destroy(this.ddlb_mole)
destroy(this.st_32)
destroy(this.sle_olemps)
destroy(this.cb_11)
end on

type cbx_7 from checkbox within tabole
integer x = 18
integer y = 8
integer width = 1047
integer height = 72
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
boolean enabled = false
string text = "Seguridad Integrada con Sistema Operativo"
boolean checked = true
end type

type st_56 from statictext within tabole
integer x = 14
integer y = 76
integer width = 343
integer height = 56
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Proveedor:"
boolean focusrectangle = false
end type

type ddlb_mole from dropdownlistbox within tabole
integer x = 9
integer y = 136
integer width = 850
integer height = 400
integer taborder = 50
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string item[] = {"SQLOLEDB"}
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN	 RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_PROVIDER_MIPRES", Regstring!, text )
if ls_pro=64 THEN	 RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_PROVIDER_MIPRES", Regstring!, text )
if text='' then text='SQLOLEDB'
end event

type st_32 from statictext within tabole
integer x = 896
integer y = 72
integer width = 480
integer height = 52
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Archivo de Conexión:"
boolean focusrectangle = false
end type

type sle_olemps from singlelineedit within tabole
integer x = 891
integer y = 132
integer width = 1618
integer height = 84
integer taborder = 31
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "OLE_FILE_MIPRES", Regstring!, text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "OLE_FILE_MIPRES", Regstring!, text )
end event

type cb_11 from commandbutton within tabole
integer x = 2519
integer y = 132
integer width = 91
integer height = 84
integer taborder = 31
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "..."
end type

event clicked;string nombre
GetFileOpenName ( 'Archivo de Conexión de Datos',sle_olemps.text, nombre , '*.udl' , "Archivos UDL (*.udl),*.udl"  , sle_olemps.text)

end event

type cbx_mipres from checkbox within tab_mipres
integer x = 50
integer y = 36
integer width = 608
integer height = 72
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Base de datos Mipres:"
end type

event clicked;tab_1.tabpage_1.tab_5.tabpage_4.tab_3.visible=checked
end event

event constructor;string ojo
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "BASE_MIPRES", Regstring!, ojo)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "BASE_MIPRES", Regstring!, ojo)
if ojo='1' then
	checked=true
	tab_1.tab_mipres.tab_7.visible=true
	tab_1.tab_mipres.st_token.visible=true
	tab_1.tab_mipres.sle_mptoken.visible=true
else
	checked=false
	tab_1.tab_mipres.tab_7.visible=false
	tab_1.tab_mipres.st_token.visible=false
	tab_1.tab_mipres.sle_mptoken.visible=false
end if
end event

type sle_3 from singlelineedit within w_para_grales_new
integer x = 238
integer y = 104
integer width = 1344
integer height = 76
integer taborder = 10
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
textcase textcase = upper!
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "CLIENTE", Regstring!, this.text )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "CLIENTE", Regstring!, this.text )

end event

type st_13 from statictext within w_para_grales_new
integer x = 654
integer y = 432
integer width = 242
integer height = 56
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Licencias:"
boolean focusrectangle = false
end type

type em_3 from editmask within w_para_grales_new
integer x = 645
integer y = 496
integer width = 279
integer height = 88
integer taborder = 40
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "none"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
string mask = "###"
boolean spin = true
double increment = 1
string minmax = "1~~999"
end type

event constructor;if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "NROLICEN", Regstring!, text )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "NROLICEN", Regstring!, text )
if text='1000' then 
	visible=false
	ilim_asis.checked=true
end if
end event

type rb_2 from radiobutton within w_para_grales_new
integer x = 114
integer y = 600
integer width = 320
integer height = 64
integer taborder = 60
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Por tiempo"
end type

event clicked;em_2.visible=true
st_14.visible=true
end event

type st_14 from statictext within w_para_grales_new
integer x = 640
integer y = 600
integer width = 293
integer height = 56
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Válida Hasta"
boolean focusrectangle = false
end type

type em_cont from editmask within w_para_grales_new
integer x = 983
integer y = 900
integer width = 297
integer height = 72
integer taborder = 140
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "0000/00"
borderstyle borderstyle = stylelowered!
maskdatatype maskdatatype = datemask!
string mask = "yyyy/mm"
boolean spin = true
double increment = 1
string minmax = "2001/01~~2100/12"
end type

event constructor;if ls_pro=32 THEN RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "HASTA_CONT", Regstring!, this.text )
if ls_pro=64 THEN RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "HASTA_CONT", Regstring!, this.text )

end event

type st_15 from statictext within w_para_grales_new
integer x = 91
integer y = 1844
integer width = 192
integer height = 56
boolean bringtotop = true
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "CLAVE"
boolean focusrectangle = false
end type

type sle_5 from singlelineedit within w_para_grales_new
integer x = 288
integer y = 1832
integer width = 590
integer height = 84
integer taborder = 440
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean enabled = false
boolean password = true
borderstyle borderstyle = stylelowered!
end type

event constructor;if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "CLAVE", Regstring!, this.text )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "CLAVE", Regstring!, this.text )
this.text=f_descripta(this.text)
end event

type st_12 from statictext within w_para_grales_new
integer x = 114
integer y = 256
integer width = 343
integer height = 52
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Aplicativo"
boolean focusrectangle = false
end type

type c_con from checkbox within w_para_grales_new
integer x = 123
integer y = 900
integer width = 411
integer height = 64
integer taborder = 90
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Contabilidad"
boolean checked = true
end type

event clicked;if this.checked then
	em_con.enabled=true
	em_cont.enabled=true
//	tab_1.tabpage_3.enabled=true
	ilim_conta.enabled=true
else
	em_con.enabled=false
	em_cont.enabled=false
//	tab_1.tabpage_3.enabled=false
	ilim_conta.enabled=false
end if
end event

event constructor;string temp
if ls_pro=32 then Registryget ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_CONT", regstring!, temp)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_CONT", regstring!, temp)
if long(temp)>0 then
	checked=true
	em_con.text=temp
	if temp='1000' then 
		em_con.visible=false
		ilim_conta.checked=true
	end if
else
	this.checked=false
	em_con.enabled=false
	em_con.text='1'
	ilim_conta.enabled=false
end if
this.triggerevent(clicked!)
end event

type c_tes from checkbox within w_para_grales_new
integer x = 123
integer y = 984
integer width = 411
integer height = 64
integer taborder = 150
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Tesorería"
boolean checked = true
end type

event clicked;if this.checked then
	em_tes.enabled=true
	em_teso.enabled=true
//	tab_1.tab_tes.enabled=true
	ilim_teso.enabled=true
else
	em_tes.enabled=false
	em_teso.enabled=false
	//tab_1.tab_tes.enabled=false
	ilim_teso.enabled=false
end if
end event

event constructor;string temp
if ls_pro=32 then Registryget ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_TESO", regstring!, temp)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_TESO", regstring!, temp)
if long(temp)>0 then
	this.checked=true
	em_tes.text=temp
	if temp='1000' then 
		em_tes.visible=false
		ilim_teso.checked=true
	end if
else
	this.checked=false
	em_tes.enabled=false
	em_tes.text='1'
	ilim_teso.enabled=false
end if
this.triggerevent(clicked!)
end event

type st_7a from statictext within w_para_grales_new
integer x = 635
integer y = 844
integer width = 229
integer height = 52
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Licencias"
boolean focusrectangle = false
end type

type em_con from editmask within w_para_grales_new
integer x = 544
integer y = 900
integer width = 183
integer height = 72
integer taborder = 120
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
string text = "1"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
string mask = "#####"
end type

type em_tes from editmask within w_para_grales_new
integer x = 544
integer y = 984
integer width = 183
integer height = 72
integer taborder = 160
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
string text = "1"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
string mask = "#####"
end type

type em_sum from editmask within w_para_grales_new
integer x = 544
integer y = 1068
integer width = 183
integer height = 72
integer taborder = 200
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
string text = "1"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
string mask = "#####"
end type

type em_car from editmask within w_para_grales_new
integer x = 544
integer y = 1152
integer width = 183
integer height = 72
integer taborder = 240
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
string text = "1"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
string mask = "#####"
end type

type em_act from editmask within w_para_grales_new
integer x = 544
integer y = 1236
integer width = 183
integer height = 72
integer taborder = 280
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
string text = "1"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
string mask = "#####"
end type

type em_nom from editmask within w_para_grales_new
integer x = 544
integer y = 1320
integer width = 183
integer height = 72
integer taborder = 320
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
string text = "1"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
string mask = "#####"
end type

type em_cos from editmask within w_para_grales_new
integer x = 544
integer y = 1404
integer width = 183
integer height = 72
integer taborder = 360
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
string text = "1"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
string mask = "#####"
end type

type em_pre from editmask within w_para_grales_new
integer x = 544
integer y = 1492
integer width = 183
integer height = 72
integer taborder = 400
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
string text = "1"
alignment alignment = center!
borderstyle borderstyle = stylelowered!
string mask = "#####"
end type

type c_pre from checkbox within w_para_grales_new
integer x = 123
integer y = 1492
integer width = 375
integer height = 64
integer taborder = 390
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Presupuesto"
boolean checked = true
end type

event clicked;if this.checked then
	em_pre.enabled=true
	em_pres.enabled=true
//	tab_1.tab_pre.enabled=true
	ilim_pres.enabled=true
else
	em_pre.enabled=false
	em_pres.enabled=false
//	tab_1.tab_pre.enabled=false
	ilim_pres.enabled=false
end if
end event

event constructor;string temp
if ls_pro=32 then Registryget ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_PRES", regstring!, temp)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_PRES", regstring!, temp)
if long(temp)>0 then
	this.checked=true
	em_pre.text=temp
	if temp='1000' then 
		em_pres.visible=false
		ilim_pres.checked=true
	end if
else
	this.checked=false
	em_pre.enabled=false
	em_pre.text='1'
	ilim_pres.enabled=false
end if
this.triggerevent(clicked!)
end event

type c_cos from checkbox within w_para_grales_new
integer x = 123
integer y = 1404
integer width = 411
integer height = 64
integer taborder = 350
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Costos"
boolean checked = true
end type

event clicked;if this.checked then
	em_cos.enabled=true
	em_cost.enabled=true
	//tab_1.tab_cos.enabled=true
	ilim_cost.enabled=true
else
	em_cos.enabled=false
	em_cost.enabled=false
	//tab_1.tab_cos.enabled=false
	ilim_cost.enabled=false
end if
end event

event constructor;string temp
if ls_pro=32 then Registryget ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_COST", regstring!, temp)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_COST", regstring!, temp)
if long(temp)>0 then
	this.checked=true
	em_cos.text=temp
	if temp='1000' then 
		em_cos.visible=false
		ilim_cost.checked=true
	end if
else
	this.checked=false
	em_cos.enabled=false
	em_cos.text='1'
	ilim_cost.enabled=false
end if
this.triggerevent(clicked!)
end event

type c_nom from checkbox within w_para_grales_new
integer x = 123
integer y = 1320
integer width = 411
integer height = 64
integer taborder = 310
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Nómina"
boolean checked = true
end type

event clicked;if this.checked then
	em_nom.enabled=true
	em_nomi.enabled=true
//	tab_1.tab_nom.enabled=true
	ilim_nomi.enabled=true
else
	em_nom.enabled=false
	em_nomi.enabled=false
//	tab_1.tab_nom.enabled=false
	ilim_nomi.enabled=false
end if
end event

event constructor;string temp
if ls_pro=32 then Registryget ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_NOMI", regstring!, temp)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_NOMI", regstring!, temp)
if long(temp)>0 then
	this.checked=true
	em_nom.text=temp
	if temp='1000' then 
		em_nom.visible=false
		ilim_nomi.checked=true
	end if
else
	this.checked=false
	em_nom.enabled=false
	em_nom.text='1'
	ilim_nomi.enabled=false
end if
this.triggerevent(clicked!)
end event

type c_act from checkbox within w_para_grales_new
integer x = 123
integer y = 1236
integer width = 375
integer height = 64
integer taborder = 270
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Activos Fijos"
boolean checked = true
end type

event clicked;if this.checked then
	em_act.enabled=true
	em_acti.enabled=true
//	tab_1.tabpage_5.enabled=true
	ilim_acti.enabled=true
else
	em_act.enabled=false
	em_acti.enabled=false
//	tab_1.tabpage_5.enabled=false
	ilim_acti.enabled=false
end if
end event

event constructor;string temp
if ls_pro=32 then Registryget ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_ACTI", regstring!, temp)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_ACTI", regstring!, temp)
if long(temp)>0 then
	this.checked=true
	em_act.text=temp
	if temp='1000' then 
		em_act.visible=false
		ilim_acti.checked=true
	end if
else
	this.checked=false
	em_act.enabled=false
	em_act.text='1'
	ilim_acti.enabled=false
end if
this.triggerevent(clicked!)
end event

type c_car from checkbox within w_para_grales_new
integer x = 123
integer y = 1152
integer width = 411
integer height = 64
integer taborder = 230
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Cartera"
boolean checked = true
end type

event clicked;if this.checked then
	em_car.enabled=true
	em_cart.enabled=true
//	tab_1.tab_car.enabled=true
	ilim_cart.enabled=true
else
	em_car.enabled=false
	em_cart.enabled=false
//	tab_1.tab_car.enabled=false
	ilim_cart.enabled=false
end if
end event

event constructor;string temp
if ls_pro=32 then Registryget ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_CART", regstring!, temp)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_CART", regstring!, temp)
if long(temp)>0 then
	this.checked=true
	em_car.text=temp
	if temp='1000' then 
		em_car.visible=false
		ilim_cart.checked=true
	end if
else
	this.checked=false
	em_car.enabled=false
	em_car.text='1'
	ilim_cart.enabled=false
end if
this.triggerevent(clicked!)
end event

type c_sum from checkbox within w_para_grales_new
integer x = 123
integer y = 1068
integer width = 411
integer height = 64
integer taborder = 190
boolean bringtotop = true
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "MS Sans Serif"
long textcolor = 33554432
long backcolor = 67108864
string text = "Suministros"
boolean checked = true
end type

event clicked;if this.checked then
	em_sum.enabled=true
	em_sumi.enabled=true
	tab_1.tabpage_1.cbx_muevek.enabled=true
	ilim_sumi.enabled=true
else
	em_sum.enabled=false
	em_sumi.enabled=false
	tab_1.tabpage_1.cbx_muevek.enabled=false
	ilim_sumi.enabled=false
end if
end event

event constructor;string temp
if ls_pro=32 then Registryget ( "HKEY_LOCAL_MACHINE\SOFTWARE\GCI\", "LIC_SUMI", regstring!, temp)
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\", "LIC_SUMI", regstring!, temp)
if long(temp)>0 then
	this.checked=true
	em_sum.text=temp
	if temp='1000' then 
		em_sum.visible=false
		ilim_sumi.checked=true
	end if
else
	this.checked=false
	em_sum.enabled=false
	em_sum.text='1'
	ilim_sumi.enabled=false
end if
this.triggerevent(clicked!)
end event

type gb_18 from groupbox within w_para_grales_new
integer x = 78
integer y = 824
integer width = 795
integer height = 176
integer taborder = 100
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Biometria"
end type

type gb_19 from groupbox within w_para_grales_new
integer x = 78
integer y = 824
integer width = 795
integer height = 176
integer taborder = 110
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Biometria"
end type

type ddlb_4 from dropdownlistbox within w_para_grales_new
integer x = 110
integer y = 324
integer width = 1399
integer height = 576
integer taborder = 30
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
string text = "none"
boolean border = false
boolean hscrollbar = true
boolean vscrollbar = true
string item[] = {"CONSULTORIO","APOYO DIAGNOSTICO","ESPECIALISTA","CONSULTA EXTERNA","CLINICA","HOSPITAL","ODONTOLOGIA"}
borderstyle borderstyle = stylelowered!
end type

event constructor;string aplicac,cual
if ls_pro=32 then RegistryGet ("HKEY_LOCAL_MACHINE\SOFTWARE\GCI\","APLICATIVO", Regstring!, aplicac )
if ls_pro=64 then RegistryGet ("HKEY_CURRENT_USER\SOFTWARE\GCI\","APLICATIVO", Regstring!, aplicac )
choose case aplicac
	case "1"
		cual="CONSULTORIO"
	case "2"
		cual="APOYO DIAGNOSTICO"
	case "3"
		cual="ESPECIALISTA"
	case "4"
		cual="CONSULTA EXTERNA"
	case "5"
		cual="CLINICA"
	case "6"
		cual="HOSPITAL"
	case "7"
		cual="ODONTOLOGIA"
	case "8"
		cual="CONSULTORIO + APIDOCKER"
	case "9"
		cual="APOYO DIAGNOSTICO + APIDOCKER"
	case "10"
		cual="ESPECIALISTA + APIDOCKER"
	case "11"
		cual="CONSULTA EXTERNA + APIDOCKER"
	case "12"
		cual="CLINICA + APIDOCKER"
	case "13"
		cual="HOSPITAL + APIDOCKER"
	case "14"
		cual="ODONTOLOGIA + APIDOCKER"		
end choose
this.text=cual
end event

type gb_8 from groupbox within w_para_grales_new
integer x = 78
integer y = 168
integer width = 1490
integer height = 584
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
end type

type gb_4 from groupbox within w_para_grales_new
integer x = 46
integer y = 32
integer width = 1559
integer height = 1924
integer textsize = -8
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Validación de Licencias:"
end type

